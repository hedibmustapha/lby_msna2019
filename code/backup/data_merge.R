# Ready to summarize all our data
# PLEASE! Remember to source the data, questionnaire, choices, and weights from preliminary_weighted_analysis.R
source("code/data_merge_prep.R")

dm_file <- dm_data %>%
  summarize(age_hoh = weighted_median(age_hoh, .),
            male_hoh = percent_response(sex_hoh, ., "male"),
            female_hoh = percent_response(sex_hoh, ., "female"),
            total_people = weighted_sum(size_hh, .),
            size_hh = weighted_median(size_hh, .),
            infants_female = round( 100 * (weighted_sum(nb_infants_female, .) / total_people), 0),
            children_female = round( 100 * (weighted_sum(nb_children_female, .) / total_people), 0),
            youth_female = round( 100 * (weighted_sum(nb_youth_female, .) / total_people), 0),
            adults_female = round( 100 * (weighted_sum(nb_adults_female, .) / total_people), 0),
            elderly_female = round( 100 * (weighted_sum(nb_elderly_female, .) / total_people), 0),
            infants_male = round( 100 * (weighted_sum(nb_infants_male, .) / total_people), 0),
            children_male = round( 100 * (weighted_sum(nb_children_male, .) / total_people), 0),
            youth_male = round( 100 * (weighted_sum(nb_youth_male, .) / total_people), 0),
            adults_male = round( 100 * (weighted_sum(nb_adults_male, .) / total_people), 0),
            elderly_male = round( 100 * (weighted_sum(nb_elderly_male, .) / total_people), 0),
            displ_2011 = percent_response(initially_displaced_year, ., "displaced_2011"),
            displ_2012 = percent_response(initially_displaced_year, ., "displaced_2012"),
            displ_2013 = percent_response(initially_displaced_year, ., "displaced_2013"),
            displ_2014 = percent_response(initially_displaced_year, ., "displaced_2014"),
            displ_2015 = percent_response(initially_displaced_year, ., "displaced_2015"),
            displ_2016 = percent_response(initially_displaced_year, ., "displaced_2016"),
            displ_2017 = percent_response(initially_displaced_year, ., "displaced_2017"),
            displ_2018 = percent_response(initially_displaced_year, ., "displaced_2018"),
            displ_2019 = percent_response(initially_displaced_year, ., "displaced_2019"),
            return_2011 = percent_response(returned_year, ., "displaced_2011"),
            return_2012 = percent_response(returned_year, ., "displaced_2012"),
            return_2013 = percent_response(returned_year, ., "displaced_2013"),
            return_2014 = percent_response(returned_year, ., "displaced_2014"),
            return_2015 = percent_response(returned_year, ., "displaced_2015"),
            return_2016 = percent_response(returned_year, ., "displaced_2016"),
            return_2017 = percent_response(returned_year, ., "displaced_2017"),
            return_2018 = percent_response(returned_year, ., "displaced_2018"),
            return_2019 = percent_response(returned_year, ., "displaced_2019"),
            displaced_once = num_percent_response(times_displaced_since_2011, ., 1),
            displaced_twice = num_percent_response(times_displaced_since_2011, ., 2),
            displaced_thrice = num_percent_response(times_displaced_since_2011, ., 3),
            displaced_four_plus = num_percent_response(times_displaced_since_2011, ., 4:max(times_displaced_since_2011, na.rm = T)),
            push_factor_1_name = select_percents(push_factors, 1, ., questions, choices, "label"),
            push_factor_1_pct = select_percents(push_factors, 1, ., questions, choices, "percent"),
            push_factor_2_name = select_percents(push_factors, 2, ., questions, choices, "label"),
            push_factor_2_pct = select_percents(push_factors, 2, ., questions, choices, "percent"),
            push_factor_3_name = select_percents(push_factors, 3, ., questions, choices, "label"),
            push_factor_3_pct = select_percents(push_factors, 3, ., questions, choices, "percent"),
            no_return_1_name = select_percents(didnt_return_home_reasons, 1, ., questions, choices, "label"),
            no_return_1_pct = select_percents(didnt_return_home_reasons, 1, ., questions, choices, "percent"),
            no_return_2_name = select_percents(didnt_return_home_reasons, 2, ., questions, choices, "label"),
            no_return_2_pct = select_percents(didnt_return_home_reasons, 2, ., questions, choices, "percent"),
            no_return_3_name = select_percents(didnt_return_home_reasons, 3, ., questions, choices, "label"),
            no_return_3_pct = select_percents(didnt_return_home_reasons, 3, ., questions, choices, "percent"),
            returnee_incident_1_name = select_percents(returnee_issues, 1, ., questions, choices, "label"),
            returnee_incident_1_pct = select_percents(returnee_issues, 1, ., questions, choices, "percent"),
            returnee_incident_2_name = select_percents(returnee_issues, 2, ., questions, choices, "label"),
            returnee_incident_2_pct = select_percents(returnee_issues, 2, ., questions, choices, "percent"),
            returnee_incident_3_name = select_percents(returnee_issues, 3, ., questions, choices, "label"),
            returnee_incident_3_pct = select_percents(returnee_issues, 3, ., questions, choices, "percent"),
            returnee_fcs_poor = percent_response(filter(., displacement_status == "returnee")[["fcs_category"]],
                                                 filter(., displacement_status == "returnee"),
                                                 "poor",
                                                 x_name = "fcs_category"),
            returnee_fcs_borderline = percent_response(filter(., displacement_status == "returnee")[["fcs_category"]],
                                                       filter(., displacement_status == "returnee"),
                                                       "borderline",
                                                       x_name = "fcs_category"),
            returnee_fcs_acceptable = percent_response(filter(., displacement_status == "returnee")[["fcs_category"]],
                                                       filter(., displacement_status == "returnee"),
                                                 "acceptable",
                                                 x_name = "fcs_category"),
            idp_fcs_poor = percent_response(filter(., displacement_status == "idp")[["fcs_category"]],
                                            filter(., displacement_status == "idp"),
                                            "poor",
                                            x_name = "fcs_category"),
            idp_fcs_borderline = percent_response(filter(., displacement_status == "idp")[["fcs_category"]],
                                                  filter(., displacement_status == "idp"),
                                                  "borderline",
                                                  x_name = "fcs_category"),
            idp_fcs_acceptable = percent_response(filter(., displacement_status == "idp")[["fcs_category"]],
                                                  filter(., displacement_status == "idp"),
                                                  "acceptable",
                                                  x_name = "fcs_category"),
            non_displaced_fcs_poor = percent_response(filter(., displacement_status == "non_displaced")[["fcs_category"]],
                                                      filter(., displacement_status == "non_displaced"),
                                                      "poor",
                                                      x_name = "fcs_category"),
            non_displaced_fcs_borderline = percent_response(filter(., displacement_status == "non_displaced")[["fcs_category"]],
                                                            filter(., displacement_status == "non_displaced"),
                                                            "borderline",
                                                            x_name = "fcs_category"),
            non_displaced_fcs_acceptable = percent_response(filter(., displacement_status == "non_displaced")[["fcs_category"]],
                                                            filter(., displacement_status == "non_displaced"),
                                                            "acceptable",
                                                            x_name = "fcs_category"),
            returnee_rcsi_low = percent_response(filter(., displacement_status == "returnee")[["rcsi_category"]],
                                                 filter(., displacement_status == "returnee"),
                                                 "low",
                                                 x_name = "rcsi_category"),
            returnee_rcsi_medium = percent_response(filter(., displacement_status == "returnee")[["rcsi_category"]],
                                                 filter(., displacement_status == "returnee"),
                                                 "medium",
                                                 x_name = "rcsi_category"),
            returnee_rcsi_high = percent_response(filter(., displacement_status == "returnee")[["rcsi_category"]],
                                                 filter(., displacement_status == "returnee"),
                                                 "high",
                                                 x_name = "rcsi_category"),
            idp_rcsi_low = percent_response(filter(., displacement_status == "idp")[["rcsi_category"]],
                                                 filter(., displacement_status == "idp"),
                                                 "low",
                                            x_name = "rcsi_category"),
            idp_rcsi_medium = percent_response(filter(., displacement_status == "idp")[["rcsi_category"]],
                                                    filter(., displacement_status == "idp"),
                                                    "medium",
                                               x_name = "rcsi_category"),
            idp_rcsi_high = percent_response(filter(., displacement_status == "idp")[["rcsi_category"]],
                                                  filter(., displacement_status == "idp"),
                                                  "high",
                                             x_name = "rcsi_category"),
            non_displaced_rcsi_low = percent_response(filter(., displacement_status == "non_displaced")[["rcsi_category"]],
                                                 filter(., displacement_status == "non_displaced"),
                                                 "low",
                                                 x_name = "rcsi_category"),
            non_displaced_rcsi_medium = percent_response(filter(., displacement_status == "non_displaced")[["rcsi_category"]],
                                                    filter(., displacement_status == "non_displaced"),
                                                    "medium",
                                                    x_name = "rcsi_category"),
            non_displaced_rcsi_high = percent_response(filter(., displacement_status == "non_displaced")[["rcsi_category"]],
                                                  filter(., displacement_status == "non_displaced"),
                                                  "high",
                                                  x_name = "rcsi_category"),
            food_source_1_name = select_percents(food_source, 1, ., questions, choices, "label"),
            food_source_1_pct = select_percents(food_source, 1, ., questions, choices, "percent"),
            food_source_2_name = select_percents(food_source, 2, ., questions, choices, "label"),
            food_source_2_pct = select_percents(food_source, 2, ., questions, choices, "percent"),
            food_source_3_name = select_percents(food_source, 3, ., questions, choices, "label"),
            food_source_3_pct = select_percents(food_source, 3, ., questions, choices, "percent"),
            crop_production = percent_response(agricultural_production, ., "crop_production"),
            livestock_production = percent_response(agricultural_production, ., "livestock_production"),
            fishing_production = percent_response(agricultural_production, ., "fishing_production"),
            previous_activity = percent_response(agricultural_production_prior2011, ., "yes"),
            crop_previously = percent_response(agricultural_activities_prior2011, ., "crop_production_activity"),
            livestock_previously = percent_response(agricultural_activities_prior2011, ., "livestock_activity"),
            fishing_previously = percent_response(agricultural_activities_prior2011, ., "fishing_activity"),
            other_activity_previously = percent_response(agricultural_activities_prior2011, ., "other"),
            crop_prod_challenges_1_name = select_percents(crop_production_challenges, 1, ., questions, choices, "label"),
            crop_prod_challenges_1_pct = select_percents(crop_production_challenges, 1, ., questions, choices, "percent"),
            crop_prod_challenges_2_name = select_percents(crop_production_challenges, 2, ., questions, choices, "label"),
            crop_prod_challenges_2_pct = select_percents(crop_production_challenges, 2, ., questions, choices, "percent"),
            crop_prod_challenges_3_name = select_percents(crop_production_challenges, 3, ., questions, choices, "label"),
            crop_prod_challenges_3_pct = select_percents(crop_production_challenges, 3, ., questions, choices, "percent"),
            crop_prod_challenges_4_name = select_percents(crop_production_challenges, 4, ., questions, choices, "label"),
            crop_prod_challenges_4_pct = select_percents(crop_production_challenges, 4, ., questions, choices, "percent"),
            livestock_prod_challenges_1_name = select_percents(livestock_production_challenges, 1, ., questions, choices, "label"),
            livestock_prod_challenges_1_pct = select_percents(livestock_production_challenges, 1, ., questions, choices, "percent"),
            livestock_prod_challenges_2_name = select_percents(livestock_production_challenges, 2, ., questions, choices, "label"),
            livestock_prod_challenges_2_pct = select_percents(livestock_production_challenges, 2, ., questions, choices, "percent"),
            livestock_prod_challenges_3_name = select_percents(livestock_production_challenges, 3, ., questions, choices, "label"),
            livestock_prod_challenges_3_pct = select_percents(livestock_production_challenges, 3, ., questions, choices, "percent"),
            livestock_prod_challenges_4_name = select_percents(livestock_production_challenges, 4, ., questions, choices, "label"),
            livestock_prod_challenges_4_pct = select_percents(livestock_production_challenges, 4, ., questions, choices, "percent"),
            fishing_challenges_1_name = select_percents(fishing_challenges, 1, ., questions, choices, "label"),
            fishing_challenges_1_pct = select_percents(fishing_challenges, 1, ., questions, choices, "percent"),
            fishing_challenges_2_name = select_percents(fishing_challenges, 2, ., questions, choices, "label"),
            fishing_challenges_2_pct = select_percents(fishing_challenges, 2, ., questions, choices, "percent"),
            fishing_challenges_3_name = select_percents(fishing_challenges, 3, ., questions, choices, "label"),
            fishing_challenges_3_pct = select_percents(fishing_challenges, 3, ., questions, choices, "percent"),
            fishing_challenges_4_name = select_percents(fishing_challenges, 4, ., questions, choices, "label"),
            fishing_challenges_4_pct = select_percents(fishing_challenges, 4, ., questions, choices, "percent"),
            type_crops_1_name = select_percents(types_crops, 1, ., questions, choices, "label"),
            type_crops_1_pct = select_percents(types_crops, 1, ., questions, choices, "percent"),
            type_crops_2_name = select_percents(types_crops, 2, ., questions, choices, "label"),
            type_crops_2_pct = select_percents(types_crops, 2, ., questions, choices, "percent"),
            type_crops_3_name = select_percents(types_crops, 3, ., questions, choices, "label"),
            type_crops_3_pct = select_percents(types_crops, 3, ., questions, choices, "percent"),
            crop_prod_impacted = percent_response(crisis_affected_crop_production, ., "yes"),
            livestock_prod_impacted = percent_response(crisis_affected_livestock_production, ., "yes"),
            returnee_adults = sum(filter(., displacement_status == "returnee")[["nb_over18"]] * dm_weights(filter(., displacement_status == "returnee"), "nb_over18")),
            returnee_adult_perm_job = sum(filter(., displacement_status == "returnee")[["permanent_job_adult"]] * dm_weights(filter(., displacement_status == "returnee"), "permanent_job_adult")),
            returnee_adult_temp_job = sum(filter(., displacement_status == "returnee")[["temporary_job_adult"]] * dm_weights(filter(., displacement_status == "returnee"), "temporary_job_adult")),
            returnee_adult_daily_labour = sum(filter(., displacement_status == "returnee")[["daily_labour_job_adult"]] * dm_weights(filter(., displacement_status == "returnee"), "daily_labour_job_adult")),
            returnee_adult_gvt_payroll = sum(filter(., displacement_status == "returnee")[["gvt_payroll_job_adult"]] * dm_weights(filter(., displacement_status == "returnee"), "gvt_payroll_job_adult")),
            idp_adults = sum(filter(., displacement_status == "idp")[["nb_over18"]] * dm_weights(filter(., displacement_status == "idp"), "nb_over18")),
            idp_adult_perm_job = sum(filter(., displacement_status == "idp")[["permanent_job_adult"]] * dm_weights(filter(., displacement_status == "idp"), "permanent_job_adult")),
            idp_adult_temp_job = sum(filter(., displacement_status == "idp")[["temporary_job_adult"]] * dm_weights(filter(., displacement_status == "idp"), "temporary_job_adult")),
            idp_adult_daily_labour = sum(filter(., displacement_status == "idp")[["daily_labour_job_adult"]] * dm_weights(filter(., displacement_status == "idp"), "daily_labour_job_adult")),
            idp_adult_gvt_payroll = sum(filter(., displacement_status == "idp")[["gvt_payroll_job_adult"]] * dm_weights(filter(., displacement_status == "idp"), "gvt_payroll_job_adult")),
            non_displaced_adults = sum(filter(., displacement_status == "non_displaced")[["nb_over18"]] * dm_weights(filter(., displacement_status == "non_displaced"), "nb_over18")),
            non_displaced_adult_perm_job = sum(filter(., displacement_status == "non_displaced")[["permanent_job_adult"]] * dm_weights(filter(., displacement_status == "non_displaced"), "permanent_job_adult")),
            non_displaced_adult_temp_job = sum(filter(., displacement_status == "non_displaced")[["temporary_job_adult"]] * dm_weights(filter(., displacement_status == "non_displaced"), "temporary_job_adult")),
            non_displaced_adult_daily_labour = sum(filter(., displacement_status == "non_displaced")[["daily_labour_job_adult"]] * dm_weights(filter(., displacement_status == "non_displaced"), "daily_labour_job_adult")),
            non_displaced_adult_gvt_payroll = sum(filter(., displacement_status == "non_displaced")[["gvt_payroll_job_adult"]] * dm_weights(filter(., displacement_status == "non_displaced"), "gvt_payroll_job_adult")),
            returnee_minors = sum(filter(., displacement_status == "returnee")[["nb_under18"]] * dm_weights(filter(., displacement_status == "returnee"), "nb_under18")),
            returnee_minor_perm_job = sum(filter(., displacement_status == "returnee")[["permanent_job_minor"]] * dm_weights(filter(., displacement_status == "returnee"), "permanent_job_minor")),
            returnee_minor_temp_job = sum(filter(., displacement_status == "returnee")[["temporary_job_minor"]] * dm_weights(filter(., displacement_status == "returnee"), "temporary_job_minor")),
            returnee_minor_daily_labour = sum(filter(., displacement_status == "returnee")[["daily_labour_job_minor"]] * dm_weights(filter(., displacement_status == "returnee"), "daily_labour_job_minor")),
            idp_minors = sum(filter(., displacement_status == "idp")[["nb_under18"]] * dm_weights(filter(., displacement_status == "idp"), "nb_under18")),
            idp_minor_perm_job = sum(filter(., displacement_status == "idp")[["permanent_job_minor"]] * dm_weights(filter(., displacement_status == "idp"), "permanent_job_minor")),
            idp_minor_temp_job = sum(filter(., displacement_status == "idp")[["temporary_job_minor"]] * dm_weights(filter(., displacement_status == "idp"), "temporary_job_minor")),
            idp_minor_daily_labour = sum(filter(., displacement_status == "idp")[["daily_labour_job_minor"]] * dm_weights(filter(., displacement_status == "idp"), "daily_labour_job_minor")),
            non_displaced_minors = sum(filter(., displacement_status == "non_displaced")[["nb_under18"]] * dm_weights(filter(., displacement_status == "non_displaced"), "nb_under18")),
            non_displaced_minor_perm_job = sum(filter(., displacement_status == "non_displaced")[["permanent_job_minor"]] * dm_weights(filter(., displacement_status == "non_displaced"), "permanent_job_minor")),
            non_displaced_minor_temp_job = sum(filter(., displacement_status == "non_displaced")[["temporary_job_minor"]] * dm_weights(filter(., displacement_status == "non_displaced"), "temporary_job_minor")),
            non_displaced_minor_daily_labour = sum(filter(., displacement_status == "non_displaced")[["daily_labour_job_minor"]] * dm_weights(filter(., displacement_status == "non_displaced"), "daily_labour_job_minor")),
            total_working_male = weighted_sum(calcul_type_institution_male, .),
            gvt_public_sector_male = round(100 * weighted_sum(gvt_public_sector_male, .) / total_working_male, 0),
            libyan_owned_business_male = round(100 * weighted_sum(libyan_owned_business_male, .) / total_working_male, 0),
            foreign_owned_business_male = round(100 * weighted_sum(foreign_owned_business_male, .) / total_working_male, 0),
            libyan_ngos_csos_male = round(100 * weighted_sum(libyan_ngos_csos_male, .) / total_working_male, 0),
            international_ngos_male = round(100 * weighted_sum(international_ngos_male, .) / total_working_male, 0),
            own_family_business_male = round(100 * weighted_sum(own_family_business_male, .) / total_working_male, 0),
            informal_irregular_labour_male = round(100 * weighted_sum(informal_irregular_labour_male, .) / total_working_male, 0),
            other_institution_male = round(100 * weighted_sum(other_institution_male, .) / total_working_male, 0),
            total_working_female = weighted_sum(calcul_type_institution_female, .),
            gvt_public_sector_female = round(100 * weighted_sum(gvt_public_sector_female, .) / total_working_female, 0),
            libyan_owned_business_female = round(100 * weighted_sum(libyan_owned_business_female, .) / total_working_female, 0),
            foreign_owned_business_female = round(100 * weighted_sum(foreign_owned_business_female, .) / total_working_female, 0),
            libyan_ngos_csos_female = round(100 * weighted_sum(libyan_ngos_csos_female, .) / total_working_female, 0),
            international_ngos_female = round(100 * weighted_sum(international_ngos_female, .) / total_working_female, 0),
            own_family_business_female = round(100 * weighted_sum(own_family_business_female, .) / total_working_female, 0),
            informal_irregular_labour_female = round(100 * weighted_sum(informal_irregular_labour_female, .) / total_working_female, 0),
            other_institution_female = round(100 * weighted_sum(other_institution_female, .) / total_working_female, 0),
            returnee_gvt_salary = weighted_median(filter(., displacement_status == "returnee")[["gvt_salary"]],
                                                filter(., displacement_status == "returnee"),
                                                x_name = "gvt_salary"),
            returnee_gvt_social_benefits = weighted_median(filter(., displacement_status == "returnee")[["gvt_social_benefits"]],
                                                         filter(., displacement_status == "returnee"),
                                                         x_name = "gvt_social_benefits"),
            returnee_non_gvt_salary = weighted_median(filter(., displacement_status == "returnee")[["non_gvt_salary"]],
                                                    filter(., displacement_status == "returnee"),
                                                    x_name = "non_gvt_salary"),
            returnee_casual_labour = weighted_median(filter(., displacement_status == "returnee")[["casual_labour"]],
                                                   filter(., displacement_status == "returnee"),
                                                   x_name = "casual_labour"),
            returnee_own_business_income = weighted_median(filter(., displacement_status == "returnee")[["own_business_income"]],
                                                         filter(., displacement_status == "returnee"),
                                                         x_name = "own_business_income"),
            returnee_remittances = weighted_median(filter(., displacement_status == "returnee")[["remittances"]],
                                                 filter(., displacement_status == "returnee"),
                                                 x_name = "remittances"),
            returnee_family_support = weighted_median(filter(., displacement_status == "returnee")[["family_support"]],
                                                    filter(., displacement_status == "returnee"),
                                                    x_name = "family_support"),
            returnee_humanitarian_assistance = weighted_median(filter(., displacement_status == "returnee")[["humanitarian_assistance"]],
                                                             filter(., displacement_status == "returnee"),
                                                             x_name = "humanitarian_assistance"),
            returnee_zakat = weighted_median(filter(., displacement_status == "returnee")[["zakat"]],
                                           filter(., displacement_status == "returnee"),
                                           x_name = "zakat"),
            returnee_income_other = weighted_median(filter(., displacement_status == "returnee")[["income_other"]],
                                                  filter(., displacement_status == "returnee"),
                                                  x_name = "income_other"),
            idp_gvt_salary = weighted_median(filter(., displacement_status == "idp")[["gvt_salary"]],
                                           filter(., displacement_status == "idp"),
                                           x_name = "gvt_salary"),
            idp_gvt_social_benefits = weighted_median(filter(., displacement_status == "idp")[["gvt_social_benefits"]],
                                                    filter(., displacement_status == "idp"),
                                                    x_name = "gvt_social_benefits"),
            idp_non_gvt_salary = weighted_median(filter(., displacement_status == "idp")[["non_gvt_salary"]],
                                               filter(., displacement_status == "idp"),
                                               x_name = "non_gvt_salary"),
            idp_casual_labour = weighted_median(filter(., displacement_status == "idp")[["casual_labour"]],
                                              filter(., displacement_status == "idp"),
                                              x_name = "casual_labour"),
            idp_own_business_income = weighted_median(filter(., displacement_status == "idp")[["own_business_income"]],
                                                    filter(., displacement_status == "idp"),
                                                    x_name = "own_business_income"),
            idp_remittances = weighted_median(filter(., displacement_status == "idp")[["remittances"]],
                                            filter(., displacement_status == "idp"),
                                            x_name = "remittances"),
            idp_family_support = weighted_median(filter(., displacement_status == "idp")[["family_support"]],
                                               filter(., displacement_status == "idp"),
                                               x_name = "family_support"),
            idp_humanitarian_assistance = weighted_median(filter(., displacement_status == "idp")[["humanitarian_assistance"]],
                                                        filter(., displacement_status == "idp"),
                                                        x_name = "humanitarian_assistance"),
            idp_zakat = weighted_median(filter(., displacement_status == "idp")[["zakat"]],
                                      filter(., displacement_status == "idp"),
                                      x_name = "zakat"),
            idp_income_other = weighted_median(filter(., displacement_status == "idp")[["income_other"]],
                                             filter(., displacement_status == "idp"),
                                             x_name = "income_other"),
            non_displaced_gvt_salary = weighted_median(filter(., displacement_status == "non_displaced")[["gvt_salary"]],
                                                     filter(., displacement_status == "non_displaced"),
                                                     x_name = "gvt_salary"),
            non_displaced_gvt_social_benefits = weighted_median(filter(., displacement_status == "non_displaced")[["gvt_social_benefits"]],
                                                              filter(., displacement_status == "non_displaced"),
                                                              x_name = "gvt_social_benefits"),
            non_displaced_non_gvt_salary = weighted_median(filter(., displacement_status == "non_displaced")[["non_gvt_salary"]],
                                                         filter(., displacement_status == "non_displaced"),
                                                         x_name = "non_gvt_salary"),
            non_displaced_casual_labour = weighted_median(filter(., displacement_status == "non_displaced")[["casual_labour"]],
                                                        filter(., displacement_status == "non_displaced"),
                                                        x_name = "casual_labour"),
            non_displaced_own_business_income = weighted_median(filter(., displacement_status == "non_displaced")[["own_business_income"]],
                                                              filter(., displacement_status == "non_displaced"),
                                                              x_name = "own_business_income"),
            non_displaced_remittances = weighted_median(filter(., displacement_status == "non_displaced")[["remittances"]],
                                                      filter(., displacement_status == "non_displaced"),
                                                      x_name = "remittances"),
            non_displaced_family_support = weighted_median(filter(., displacement_status == "non_displaced")[["family_support"]],
                                                         filter(., displacement_status == "non_displaced"),
                                                         x_name = "family_support"),
            non_displaced_humanitarian_assistance = weighted_median(filter(., displacement_status == "non_displaced")[["humanitarian_assistance"]],
                                                                  filter(., displacement_status == "non_displaced"),
                                                                  x_name = "humanitarian_assistance"),
            non_displaced_zakat = weighted_median(filter(., displacement_status == "non_displaced")[["zakat"]],
                                                filter(., displacement_status == "non_displaced"),
                                                x_name = "zakat"),
            non_displaced_income_other = weighted_median(filter(., displacement_status == "non_displaced")[["income_other"]],
                                                       filter(., displacement_status == "non_displaced"),
                                                       x_name = "income_other"),
            received_cash = round(100 * sum((cash_modality[!is.na(cash_modality)] > 0) * dm_weights(., "cash_modality")) / sum(dm_weights(., "cash_modality")), 0),
            returnee_cash_challenges = percent_response(filter(., displacement_status == "returnee")[["obtaining_cash_challenge"]],
                                                        filter(., displacement_status == "returnee"),
                                                        "yes",
                                                        x_name = "obtaining_cash_challenge"),
            idp_cash_challenges = percent_response(filter(., displacement_status == "idp")[["obtaining_cash_challenge"]],
                                                   filter(., displacement_status == "idp"),
                                                   "yes",
                                                   x_name = "obtaining_cash_challenge"),
            non_displaced_cash_challenges = percent_response(filter(., displacement_status == "non_displaced")[["obtaining_cash_challenge"]],
                                                             filter(., displacement_status == "non_displaced"),
                                                             "yes",
                                                             x_name = "obtaining_cash_challenge"),
            cash_challenge_1_name = select_percents(obtaining_cash_challenge_reasons, 1, ., questions, choices, "label"),
            cash_challenge_1_pct = select_percents(obtaining_cash_challenge_reasons, 1, ., questions, choices, "percent"),
            cash_challenge_2_name = select_percents(obtaining_cash_challenge_reasons, 2, ., questions, choices, "label"),
            cash_challenge_2_pct = select_percents(obtaining_cash_challenge_reasons, 2, ., questions, choices, "percent"),
            cash_challenge_3_name = select_percents(obtaining_cash_challenge_reasons, 3, ., questions, choices, "label"),
            cash_challenge_3_pct = select_percents(obtaining_cash_challenge_reasons, 3, ., questions, choices, "percent"),
            cash_challenge_4_name = select_percents(obtaining_cash_challenge_reasons, 4, ., questions, choices, "label"),
            cash_challenge_4_pct = select_percents(obtaining_cash_challenge_reasons, 4, ., questions, choices, "percent"),
            returnee_food_expenditure = weighted_median(filter(., displacement_status == "returnee")[["food_expenditure"]],
                                                        filter(., displacement_status == "returnee"),
                                                        x_name = "food_expenditure"),
            returnee_rent_expenditure = weighted_median(filter(., displacement_status == "returnee")[["rent_expenditure"]],
                                                        filter(., displacement_status == "returnee"),
                                                        x_name = "rent_expenditure"),
            returnee_shelter_maintenance_expenditure = weighted_median(filter(., displacement_status == "returnee")[["shelter_maintenance_expenditure"]],
                                                                       filter(., displacement_status == "returnee"),
                                                                       x_name = "shelter_maintenance_expenditure"),
            returnee_water_expenditure = weighted_median(filter(., displacement_status == "returnee")[["water_expenditure"]],
                                                         filter(., displacement_status == "returnee"),
                                                         x_name = "water_expenditure"),
            returnee_nfi_expenditure = weighted_median(filter(., displacement_status == "returnee")[["nfi_expenditure"]],
                                                       filter(., displacement_status == "returnee"),
                                                       x_name = "nfi_expenditure"),
            returnee_utilities_expenditure = weighted_median(filter(., displacement_status == "returnee")[["utilities_expenditure"]],
                                                             filter(., displacement_status == "returnee"),
                                                             x_name = "utilities_expenditure"),
            returnee_fuel_expenditure = weighted_median(filter(., displacement_status == "returnee")[["fuel_expenditure"]],
                                                        filter(., displacement_status == "returnee"),
                                                        x_name = "fuel_expenditure"),
            returnee_health_related_expenditure = weighted_median(filter(., displacement_status == "returnee")[["health_related_expenditure"]],
                                                                  filter(., displacement_status == "returnee"),
                                                                  x_name = "health_related_expenditure"),
            returnee_education_related_expenditure = weighted_median(filter(., displacement_status == "returnee")[["education_related_expenditure"]],
                                                                     filter(., displacement_status == "returnee"),
                                                                     x_name = "education_related_expenditure"),
            returnee_transportation_expenditure = weighted_median(filter(., displacement_status == "returnee")[["transportation_expenditure"]],
                                                                  filter(., displacement_status == "returnee"),
                                                                  x_name = "transportation_expenditure"),
            returnee_mobile_phone_credit_expenditure = weighted_median(filter(., displacement_status == "returnee")[["mobile_phone_credit_expenditure"]],
                                                                       filter(., displacement_status == "returnee"),
                                                                       x_name = "mobile_phone_credit_expenditure"),
            returnee_productive_assets_expenditure = weighted_median(filter(., displacement_status == "returnee")[["productive_assets_expenditure"]],
                                                                     filter(., displacement_status == "returnee"),
                                                                     x_name = "productive_assets_expenditure"),
            returnee_debt_repayment_expenditure = weighted_median(filter(., displacement_status == "returnee")[["debt_repayment_expenditure"]],
                                                                  filter(., displacement_status == "returnee"),
                                                                  x_name = "debt_repayment_expenditure"),
            returnee_other_expenditure = weighted_median(filter(., displacement_status == "returnee")[["other_expenditure"]],
                                                         filter(., displacement_status == "returnee"),
                                                         x_name = "other_expenditure"),
            idp_food_expenditure = weighted_median(filter(., displacement_status == "idp")[["food_expenditure"]],
                                                        filter(., displacement_status == "idp"),
                                                        x_name = "food_expenditure"),
            idp_rent_expenditure = weighted_median(filter(., displacement_status == "idp")[["rent_expenditure"]],
                                                        filter(., displacement_status == "idp"),
                                                        x_name = "rent_expenditure"),
            idp_shelter_maintenance_expenditure = weighted_median(filter(., displacement_status == "idp")[["shelter_maintenance_expenditure"]],
                                                                       filter(., displacement_status == "idp"),
                                                                       x_name = "shelter_maintenance_expenditure"),
            idp_water_expenditure = weighted_median(filter(., displacement_status == "idp")[["water_expenditure"]],
                                                         filter(., displacement_status == "idp"),
                                                         x_name = "water_expenditure"),
            idp_nfi_expenditure = weighted_median(filter(., displacement_status == "idp")[["nfi_expenditure"]],
                                                       filter(., displacement_status == "idp"),
                                                       x_name = "nfi_expenditure"),
            idp_utilities_expenditure = weighted_median(filter(., displacement_status == "idp")[["utilities_expenditure"]],
                                                             filter(., displacement_status == "idp"),
                                                             x_name = "utilities_expenditure"),
            idp_fuel_expenditure = weighted_median(filter(., displacement_status == "idp")[["fuel_expenditure"]],
                                                        filter(., displacement_status == "idp"),
                                                        x_name = "fuel_expenditure"),
            idp_health_related_expenditure = weighted_median(filter(., displacement_status == "idp")[["health_related_expenditure"]],
                                                                  filter(., displacement_status == "idp"),
                                                                  x_name = "health_related_expenditure"),
            idp_education_related_expenditure = weighted_median(filter(., displacement_status == "idp")[["education_related_expenditure"]],
                                                                     filter(., displacement_status == "idp"),
                                                                     x_name = "education_related_expenditure"),
            idp_transportation_expenditure = weighted_median(filter(., displacement_status == "idp")[["transportation_expenditure"]],
                                                                  filter(., displacement_status == "idp"),
                                                                  x_name = "transportation_expenditure"),
            idp_mobile_phone_credit_expenditure = weighted_median(filter(., displacement_status == "idp")[["mobile_phone_credit_expenditure"]],
                                                                       filter(., displacement_status == "idp"),
                                                                       x_name = "mobile_phone_credit_expenditure"),
            idp_productive_assets_expenditure = weighted_median(filter(., displacement_status == "idp")[["productive_assets_expenditure"]],
                                                                     filter(., displacement_status == "idp"),
                                                                     x_name = "productive_assets_expenditure"),
            idp_debt_repayment_expenditure = weighted_median(filter(., displacement_status == "idp")[["debt_repayment_expenditure"]],
                                                                  filter(., displacement_status == "idp"),
                                                                  x_name = "debt_repayment_expenditure"),
            idp_other_expenditure = weighted_median(filter(., displacement_status == "idp")[["other_expenditure"]],
                                                         filter(., displacement_status == "idp"),
                                                         x_name = "other_expenditure"),
            non_displaced_food_expenditure = weighted_median(filter(., displacement_status == "non_displaced")[["food_expenditure"]],
                                                        filter(., displacement_status == "non_displaced"),
                                                        x_name = "food_expenditure"),
            non_displaced_rent_expenditure = weighted_median(filter(., displacement_status == "non_displaced")[["rent_expenditure"]],
                                                        filter(., displacement_status == "non_displaced"),
                                                        x_name = "rent_expenditure"),
            non_displaced_shelter_maintenance_expenditure = weighted_median(filter(., displacement_status == "non_displaced")[["shelter_maintenance_expenditure"]],
                                                                       filter(., displacement_status == "non_displaced"),
                                                                       x_name = "shelter_maintenance_expenditure"),
            non_displaced_water_expenditure = weighted_median(filter(., displacement_status == "non_displaced")[["water_expenditure"]],
                                                         filter(., displacement_status == "non_displaced"),
                                                         x_name = "water_expenditure"),
            non_displaced_nfi_expenditure = weighted_median(filter(., displacement_status == "non_displaced")[["nfi_expenditure"]],
                                                       filter(., displacement_status == "non_displaced"),
                                                       x_name = "nfi_expenditure"),
            non_displaced_utilities_expenditure = weighted_median(filter(., displacement_status == "non_displaced")[["utilities_expenditure"]],
                                                             filter(., displacement_status == "non_displaced"),
                                                             x_name = "utilities_expenditure"),
            non_displaced_fuel_expenditure = weighted_median(filter(., displacement_status == "non_displaced")[["fuel_expenditure"]],
                                                        filter(., displacement_status == "non_displaced"),
                                                        x_name = "fuel_expenditure"),
            non_displaced_health_related_expenditure = weighted_median(filter(., displacement_status == "non_displaced")[["health_related_expenditure"]],
                                                                  filter(., displacement_status == "non_displaced"),
                                                                  x_name = "health_related_expenditure"),
            non_displaced_education_related_expenditure = weighted_median(filter(., displacement_status == "non_displaced")[["education_related_expenditure"]],
                                                                     filter(., displacement_status == "non_displaced"),
                                                                     x_name = "education_related_expenditure"),
            non_displaced_transportation_expenditure = weighted_median(filter(., displacement_status == "non_displaced")[["transportation_expenditure"]],
                                                                  filter(., displacement_status == "non_displaced"),
                                                                  x_name = "transportation_expenditure"),
            non_displaced_mobile_phone_credit_expenditure = weighted_median(filter(., displacement_status == "non_displaced")[["mobile_phone_credit_expenditure"]],
                                                                       filter(., displacement_status == "non_displaced"),
                                                                       x_name = "mobile_phone_credit_expenditure"),
            non_displaced_productive_assets_expenditure = weighted_median(filter(., displacement_status == "non_displaced")[["productive_assets_expenditure"]],
                                                                     filter(., displacement_status == "non_displaced"),
                                                                     x_name = "productive_assets_expenditure"),
            non_displaced_debt_repayment_expenditure = weighted_median(filter(., displacement_status == "non_displaced")[["debt_repayment_expenditure"]],
                                                                  filter(., displacement_status == "non_displaced"),
                                                                  x_name = "debt_repayment_expenditure"),
            non_displaced_other_expenditure = weighted_median(filter(., displacement_status == "non_displaced")[["other_expenditure"]],
                                                         filter(., displacement_status == "non_displaced"),
                                                         x_name = "other_expenditure"),
            payment_modality_1_name = select_percents(hh_payment_modality, 1, ., questions, choices, "label"),
            payment_modality_1_pct = select_percents(hh_payment_modality, 1, ., questions, choices, "percent"),
            payment_modality_2_name = select_percents(hh_payment_modality, 2, ., questions, choices, "label"),
            payment_modality_2_pct = select_percents(hh_payment_modality, 2, ., questions, choices, "percent"),
            payment_modality_3_name = select_percents(hh_payment_modality, 3, ., questions, choices, "label"),
            payment_modality_3_pct = select_percents(hh_payment_modality, 3, ., questions, choices, "percent"),
            payment_modality_4_name = select_percents(hh_payment_modality, 4, ., questions, choices, "label"),
            payment_modality_4_pct = select_percents(hh_payment_modality, 4, ., questions, choices, "percent"),
            no_market_access = percent_response(hh_access_marketplace, ., "no"),
            distance_market_less_15 = percent_response(travel_to_market, ., "less_15min"),
            distance_market_15_30 = percent_response(travel_to_market, ., "between_15_29min"),
            distance_market_more_30 = percent_response(travel_to_market, ., "between_30_59min", "between_1_2hours", "more_2hours"),
            no_barriers_access_market = percent_response(barriers_access_market, ., "no_barriers_access_market"),
            market_barriers_1_name = select_percents(barriers_access_market, 1, ., questions, choices, "label", exclude = "no_barriers_access_market"),
            market_barriers_1_pct = select_percents(barriers_access_market, 1, ., questions, choices, "percent", exclude = "no_barriers_access_market"),
            market_barriers_2_name = select_percents(barriers_access_market, 2, ., questions, choices, "label", exclude = "no_barriers_access_market"),
            market_barriers_2_pct = select_percents(barriers_access_market, 2, ., questions, choices, "percent", exclude = "no_barriers_access_market"),
            market_barriers_3_name = select_percents(barriers_access_market, 3, ., questions, choices, "label", exclude = "no_barriers_access_market"),
            market_barriers_3_pct = select_percents(barriers_access_market, 3, ., questions, choices, "percent", exclude = "no_barriers_access_market"),
            item_barrier_too_expensive = percent_response(barriers_purchasing_items, ., "yes_items_too_expensive"),
            item_barrier_not_available = percent_response(barriers_purchasing_items, ., "yes_items_not_available"),
            item_too_expensive_1_name = select_percents(expensive_items_to_afford, 1, ., questions, choices, "label"),
            item_too_expensive_1_pct = select_percents(expensive_items_to_afford, 1, ., questions, choices, "percent"),
            item_too_expensive_2_name = select_percents(expensive_items_to_afford, 2, ., questions, choices, "label"),
            item_too_expensive_2_pct = select_percents(expensive_items_to_afford, 2, ., questions, choices, "percent"),
            item_too_expensive_3_name = select_percents(expensive_items_to_afford, 3, ., questions, choices, "label"),
            item_too_expensive_3_pct = select_percents(expensive_items_to_afford, 3, ., questions, choices, "percent"),
            item_not_available_1_name = select_percents(unabailable_items_marketplace, 1, ., questions, choices, "label"),
            item_not_available_1_pct = select_percents(unabailable_items_marketplace, 1, ., questions, choices, "percent"),
            item_not_available_2_name = select_percents(unabailable_items_marketplace, 2, ., questions, choices, "label"),
            item_not_available_2_pct = select_percents(unabailable_items_marketplace, 2, ., questions, choices, "percent"),
            item_not_available_3_name = select_percents(unabailable_items_marketplace, 3, ., questions, choices, "label"),
            item_not_available_3_pct = select_percents(unabailable_items_marketplace, 3, ., questions, choices, "percent"),
            returnee_cash_coping_stress = percent_response(filter(., displacement_status == "returnee")[["cash_coping"]],
                                                           filter(., displacement_status == "returnee"),
                                                           "stress",
                                                           x_name = "cash_coping"),
            returnee_cash_coping_crisis = percent_response(filter(., displacement_status == "returnee")[["cash_coping"]],
                                                           filter(., displacement_status == "returnee"),
                                                           "crisis",
                                                           x_name = "cash_coping"),
            returnee_cash_coping_emergency = percent_response(filter(., displacement_status == "returnee")[["cash_coping"]],
                                                              filter(., displacement_status == "returnee"),
                                                              "emergency",
                                                              x_name = "cash_coping"),
            idp_cash_coping_stress = percent_response(filter(., displacement_status == "idp")[["cash_coping"]],
                                                      filter(., displacement_status == "idp"),
                                                      "stress",
                                                      x_name = "cash_coping"),
            idp_cash_coping_crisis = percent_response(filter(., displacement_status == "idp")[["cash_coping"]],
                                                      filter(., displacement_status == "idp"),
                                                      "crisis",
                                                      x_name = "cash_coping"),
            idp_cash_coping_emergency = percent_response(filter(., displacement_status == "idp")[["cash_coping"]],
                                                         filter(., displacement_status == "idp"),
                                                         "emergency",
                                                         x_name = "cash_coping"),
            non_displaced_cash_coping_stress = percent_response(filter(., displacement_status == "non_displaced")[["cash_coping"]],
                                                                filter(., displacement_status == "non_displaced"),
                                                                "stress",
                                                                x_name = "cash_coping"),
            non_displaced_cash_coping_crisis = percent_response(filter(., displacement_status == "non_displaced")[["cash_coping"]],
                                                                filter(., displacement_status == "non_displaced"),
                                                                "crisis",
                                                                x_name = "cash_coping"),
            non_displaced_cash_coping_emergency = percent_response(filter(., displacement_status == "non_displaced")[["cash_coping"]],
                                                                   filter(., displacement_status == "non_displaced"),
                                                                   "emergency",
                                                                   x_name = "cash_coping"),
            cash_coping_reason_1_name = select_percents(using_cash_coping_mechanism_reasons, 1, ., questions, choices, "label"),
            cash_coping_reason_1_pct = select_percents(using_cash_coping_mechanism_reasons, 1, ., questions, choices, "percent"),
            cash_coping_reason_2_name = select_percents(using_cash_coping_mechanism_reasons, 2, ., questions, choices, "label"),
            cash_coping_reason_2_pct = select_percents(using_cash_coping_mechanism_reasons, 2, ., questions, choices, "percent"),
            cash_coping_reason_3_name = select_percents(using_cash_coping_mechanism_reasons, 3, ., questions, choices, "label"),
            cash_coping_reason_3_pct = select_percents(using_cash_coping_mechanism_reasons, 3, ., questions, choices, "percent"),
            cash_coping_reason_4_name = select_percents(using_cash_coping_mechanism_reasons, 4, ., questions, choices, "label"),
            cash_coping_reason_4_pct = select_percents(using_cash_coping_mechanism_reasons, 4, ., questions, choices, "percent"),
            cash_coping_reason_5_name = select_percents(using_cash_coping_mechanism_reasons, 5, ., questions, choices, "label"),
            cash_coping_reason_5_pct = select_percents(using_cash_coping_mechanism_reasons, 5, ., questions, choices, "percent"),
            cash_coping_reason_6_name = select_percents(using_cash_coping_mechanism_reasons, 6, ., questions, choices, "label"),
            cash_coping_reason_6_pct = select_percents(using_cash_coping_mechanism_reasons, 6, ., questions, choices, "percent"),
            apartment_house = percent_response(shelter_type, ., "apartment", "house"),
            unfinished_room = percent_response(shelter_type, ., "unfinished_rooms"),
            public_building = percent_response(shelter_type, ., "public_building_not_used_for_shelter"),
            private_building = percent_response(shelter_type, ., "private_building_not_used_for_shelter"),
            tent_caravan = percent_response(shelter_type, ., "tent_caravan"),
            temporary_shelter_ngos = percent_response(shelter_type, ., "temporary_shelter_ngos"),
            connection_house = percent_response(shelter_type, ., "connection_house"),
            hotel = percent_response(shelter_type, ., "hotel"),
            camp_informal_settlement = percent_response(shelter_type, ., "camp_informal_settlement"),
            other_housing = percent_response(shelter_type, ., "other"),
            returnee_occupancy_owned = percent_response(filter(., displacement_status == "returnee")[["occupancy_status"]],
                                                        filter(., displacement_status == "returnee"),
                                                        "ownership",
                                                        x_name = "occupancy_status"),
            returnee_occupancy_rented = percent_response(filter(., displacement_status == "returnee")[["occupancy_status"]],
                                                         filter(., displacement_status == "returnee"),
                                                         "rental_written_contract",
                                                         "rental_verbal_agreement",
                                                         x_name = "occupancy_status"),
            returnee_occupancy_hosted_free = percent_response(filter(., displacement_status == "returnee")[["occupancy_status"]],
                                                              filter(., displacement_status == "returnee"),
                                                              "hosted_free",
                                                              x_name = "occupancy_status"),
            returnee_occupancy_other = percent_response(filter(., displacement_status == "returnee")[["occupancy_status"]],
                                                        filter(., displacement_status == "returnee"),
                                                        "squatting",
                                                        "housing_provided_public_authority",
                                                        "housing_provided_employer",
                                                        "other",
                                                        x_name = "occupancy_status"),
            idp_occupancy_owned = percent_response(filter(., displacement_status == "idp")[["occupancy_status"]],
                                                   filter(., displacement_status == "idp"),
                                                   "ownership",
                                                   x_name = "occupancy_status"),
            idp_occupancy_rented = percent_response(filter(., displacement_status == "idp")[["occupancy_status"]],
                                                    filter(., displacement_status == "idp"),
                                                    "rental_written_contract",
                                                    "rental_verbal_agreement",
                                                    x_name = "occupancy_status"),
            idp_occupancy_hosted_free = percent_response(filter(., displacement_status == "idp")[["occupancy_status"]],
                                                         filter(., displacement_status == "idp"),
                                                         "hosted_free",
                                                         x_name = "occupancy_status"),
            idp_occupancy_other = percent_response(filter(., displacement_status == "idp")[["occupancy_status"]],
                                                   filter(., displacement_status == "idp"),
                                                   "squatting",
                                                   "housing_provided_public_authority",
                                                   "housing_provided_employer",
                                                   "other",
                                                   x_name = "occupancy_status"),
            non_displaced_occupancy_owned = percent_response(filter(., displacement_status == "non_displaced")[["occupancy_status"]],
                                                             filter(., displacement_status == "non_displaced"),
                                                             "ownership",
                                                             x_name = "occupancy_status"),
            non_displaced_occupancy_rented = percent_response(filter(., displacement_status == "non_displaced")[["occupancy_status"]],
                                                              filter(., displacement_status == "non_displaced"),
                                                              "rental_written_contract",
                                                              "rental_verbal_agreement",
                                                              x_name = "occupancy_status"),
            non_displaced_occupancy_hosted_free = percent_response(filter(., displacement_status == "non_displaced")[["occupancy_status"]],
                                                                   filter(., displacement_status == "non_displaced"),
                                                                   "hosted_free",
                                                                   x_name = "occupancy_status"),
            non_displaced_occupancy_other = percent_response(filter(., displacement_status == "non_displaced")[["occupancy_status"]],
                                                             filter(., displacement_status == "non_displaced"),
                                                             "squatting",
                                                             "housing_provided_public_authority",
                                                             "housing_provided_employer",
                                                             "other",
                                                             x_name = "occupancy_status"),
            returnee_rental_cost = weighted_median(filter(., displacement_status == "returnee")[["rental_cost"]],
                                                   filter(., displacement_status == "returnee"),
                                                   "rental_cost"),
            idp_rental_cost = weighted_median(filter(., displacement_status == "idp")[["rental_cost"]],
                                              filter(., displacement_status == "idp"),
                                              "rental_cost"),
            non_displaced_rental_cost = weighted_median(filter(., displacement_status == "non_displaced")[["rental_cost"]],
                                                        filter(., displacement_status == "non_displaced"),
                                                        "rental_cost"),
            threatened_eviction = percent_response(eviction_threat, ., "yes_threatened_with_eviction"),
            recently_evicted = percent_response(eviction_threat, ., "yes_recently_evicted"),
            eviction_reason_1_name = select_percents(eviction_shelter_reasons, 1, ., questions, choices, "label"),
            eviction_reason_1_pct = select_percents(eviction_shelter_reasons, 1, ., questions, choices, "percent"),
            eviction_reason_2_name = select_percents(eviction_shelter_reasons, 2, ., questions, choices, "label"),
            eviction_reason_2_pct = select_percents(eviction_shelter_reasons, 2, ., questions, choices, "percent"),
            eviction_reason_3_name = select_percents(eviction_shelter_reasons, 3, ., questions, choices, "label"),
            eviction_reason_3_pct = select_percents(eviction_shelter_reasons, 3, ., questions, choices, "percent"),
            nfi_need = percent_response(nfi_need, ., "has_nfi_need"),
            power_cuts = weighted_median(power_cuts, .),
            phone_coverage_reliable = percent_response(phone_network_coverage, ., "coverage_exists_reliable"),
            phone_coverage_not_reliable = percent_response(phone_network_coverage, ., "coverage_exists_not_reliable"),
            phone_coverage_none = percent_response(phone_network_coverage, ., "coverage_doesnt_exist"),
            water_source_public_network = percent_response(primary_drinkingwater_source, ., "public_network"),
            water_source_bottles = percent_response(primary_drinkingwater_source, ., "bottled_water"),
            water_source_trucks = percent_response(primary_drinkingwater_source, ., "water_trucking"),
            water_source_other = percent_response(primary_drinkingwater_source, .,
                                                  "public_tap", "protected_well", "unprotected_well",
                                                  "surface_water", "rainwater", "other"),
            water_dist_100m = percent_response(distance_drinkingwater, ., "upto_100m"),
            water_dist_200m = percent_response(distance_drinkingwater, ., "between_101_200m"),
            water_dist_300m = percent_response(distance_drinkingwater, ., "between_201_300m"),
            water_dist_400m = percent_response(distance_drinkingwater, ., "between_301_400m"),
            water_dist_500m = percent_response(distance_drinkingwater, ., "between_401_500m"),
            water_dist_more_500m = percent_response(distance_drinkingwater, ., "more_500m"),
            returnee_water_insufficient = percent_response(filter(., displacement_status == "returnee")[["unsufficient_quantity_water"]],
                                                           filter(., displacement_status == "returnee"),
                                                           "yes",
                                                           x_name = "unsufficient_quantity_water"),
            idp_water_insufficient = percent_response(filter(., displacement_status == "idp")[["unsufficient_quantity_water"]],
                                                           filter(., displacement_status == "idp"),
                                                           "yes",
                                                           x_name = "unsufficient_quantity_water"),
            non_displaced_water_insufficient = percent_response(filter(., displacement_status == "non_displaced")[["unsufficient_quantity_water"]],
                                                           filter(., displacement_status == "non_displaced"),
                                                           "yes",
                                                           x_name = "unsufficient_quantity_water"),
            water_access_every_day = percent_response(access_public_water_network, ., "every_day"),
            water_access_most_days = percent_response(access_public_water_network, ., "most_days"),
            water_access_rarely_none = percent_response(access_public_water_network, ., "rarely", "not_at_all"),
            designated_waste_disposal = percent_response(trash_disposal, .,
                                                         "collected_municipality_waste_management_service",
                                                         "designated_place_waste_disposal"),
            healthcare_challenge_yes = percent_response(access_healthcare_challenge, ., "yes"),
            healthcare_challenge_no = percent_response(access_healthcare_challenge, ., "no"),
            healthcare_challenge_dk_na = percent_response(access_healthcare_challenge, ., "dk", "dwta"),
            returnee_healthcare_challenge_1_name = select_percents(filter(., displacement_status == "returnee")[["access_healthcare_challenge_reasons"]],
                                                                   1,
                                                                   filter(., displacement_status == "returnee"),
                                                                   questions,
                                                                   choices,
                                                                   "label",
                                                                   x_name = "access_healthcare_challenge_reasons"),
            returnee_healthcare_challenge_1_pct = select_percents(filter(., displacement_status == "returnee")[["access_healthcare_challenge_reasons"]],
                                                                   1,
                                                                   filter(., displacement_status == "returnee"),
                                                                   questions,
                                                                   choices,
                                                                   "percent",
                                                                   x_name = "access_healthcare_challenge_reasons"),
            returnee_healthcare_challenge_2_name = select_percents(filter(., displacement_status == "returnee")[["access_healthcare_challenge_reasons"]],
                                                                   2,
                                                                   filter(., displacement_status == "returnee"),
                                                                   questions,
                                                                   choices,
                                                                   "label",
                                                                   x_name = "access_healthcare_challenge_reasons"),
            returnee_healthcare_challenge_2_pct = select_percents(filter(., displacement_status == "returnee")[["access_healthcare_challenge_reasons"]],
                                                                  2,
                                                                  filter(., displacement_status == "returnee"),
                                                                  questions,
                                                                  choices,
                                                                  "percent",
                                                                  x_name = "access_healthcare_challenge_reasons"),
            returnee_healthcare_challenge_3_name = select_percents(filter(., displacement_status == "returnee")[["access_healthcare_challenge_reasons"]],
                                                                   3,
                                                                   filter(., displacement_status == "returnee"),
                                                                   questions,
                                                                   choices,
                                                                   "label",
                                                                   x_name = "access_healthcare_challenge_reasons"),
            returnee_healthcare_challenge_3_pct = select_percents(filter(., displacement_status == "returnee")[["access_healthcare_challenge_reasons"]],
                                                                  3,
                                                                  filter(., displacement_status == "returnee"),
                                                                  questions,
                                                                  choices,
                                                                  "percent",
                                                                  x_name = "access_healthcare_challenge_reasons"),
            idp_healthcare_challenge_1_name = select_percents(filter(., displacement_status == "idp")[["access_healthcare_challenge_reasons"]],
                                                                   1,
                                                                   filter(., displacement_status == "idp"),
                                                                   questions,
                                                                   choices,
                                                                   "label",
                                                                   x_name = "access_healthcare_challenge_reasons"),
            idp_healthcare_challenge_1_pct = select_percents(filter(., displacement_status == "idp")[["access_healthcare_challenge_reasons"]],
                                                                  1,
                                                                  filter(., displacement_status == "idp"),
                                                                  questions,
                                                                  choices,
                                                                  "percent",
                                                                  x_name = "access_healthcare_challenge_reasons"),
            idp_healthcare_challenge_2_name = select_percents(filter(., displacement_status == "idp")[["access_healthcare_challenge_reasons"]],
                                                                   2,
                                                                   filter(., displacement_status == "idp"),
                                                                   questions,
                                                                   choices,
                                                                   "label",
                                                                   x_name = "access_healthcare_challenge_reasons"),
            idp_healthcare_challenge_2_pct = select_percents(filter(., displacement_status == "idp")[["access_healthcare_challenge_reasons"]],
                                                                  2,
                                                                  filter(., displacement_status == "idp"),
                                                                  questions,
                                                                  choices,
                                                                  "percent",
                                                                  x_name = "access_healthcare_challenge_reasons"),
            idp_healthcare_challenge_3_name = select_percents(filter(., displacement_status == "idp")[["access_healthcare_challenge_reasons"]],
                                                                   3,
                                                                   filter(., displacement_status == "idp"),
                                                                   questions,
                                                                   choices,
                                                                   "label",
                                                                   x_name = "access_healthcare_challenge_reasons"),
            idp_healthcare_challenge_3_pct = select_percents(filter(., displacement_status == "idp")[["access_healthcare_challenge_reasons"]],
                                                                  3,
                                                                  filter(., displacement_status == "idp"),
                                                                  questions,
                                                                  choices,
                                                                  "percent",
                                                                  x_name = "access_healthcare_challenge_reasons"),
            non_displaced_healthcare_challenge_1_name = select_percents(filter(., displacement_status == "non_displaced")[["access_healthcare_challenge_reasons"]],
                                                                   1,
                                                                   filter(., displacement_status == "non_displaced"),
                                                                   questions,
                                                                   choices,
                                                                   "label",
                                                                   x_name = "access_healthcare_challenge_reasons"),
            non_displaced_healthcare_challenge_1_pct = select_percents(filter(., displacement_status == "non_displaced")[["access_healthcare_challenge_reasons"]],
                                                                  1,
                                                                  filter(., displacement_status == "non_displaced"),
                                                                  questions,
                                                                  choices,
                                                                  "percent",
                                                                  x_name = "access_healthcare_challenge_reasons"),
            non_displaced_healthcare_challenge_2_name = select_percents(filter(., displacement_status == "non_displaced")[["access_healthcare_challenge_reasons"]],
                                                                   2,
                                                                   filter(., displacement_status == "non_displaced"),
                                                                   questions,
                                                                   choices,
                                                                   "label",
                                                                   x_name = "access_healthcare_challenge_reasons"),
            non_displaced_healthcare_challenge_2_pct = select_percents(filter(., displacement_status == "non_displaced")[["access_healthcare_challenge_reasons"]],
                                                                  2,
                                                                  filter(., displacement_status == "non_displaced"),
                                                                  questions,
                                                                  choices,
                                                                  "percent",
                                                                  x_name = "access_healthcare_challenge_reasons"),
            non_displaced_healthcare_challenge_3_name = select_percents(filter(., displacement_status == "non_displaced")[["access_healthcare_challenge_reasons"]],
                                                                   3,
                                                                   filter(., displacement_status == "non_displaced"),
                                                                   questions,
                                                                   choices,
                                                                   "label",
                                                                   x_name = "access_healthcare_challenge_reasons"),
            non_displaced_healthcare_challenge_3_pct = select_percents(filter(., displacement_status == "non_displaced")[["access_healthcare_challenge_reasons"]],
                                                                  3,
                                                                  filter(., displacement_status == "non_displaced"),
                                                                  questions,
                                                                  choices,
                                                                  "percent",
                                                                  x_name = "access_healthcare_challenge_reasons"),
            health_time_more_30_min = percent_response(travel_to_healthcare_provider, .,
                                                       "between_30_59min",
                                                       "between_1_2hours",
                                                       "more_2hours"),
            bottle_fed_child = percent_response(bottle_fed_child, ., "bottle_fed_child"),
            unable_vaccinate = percent_response(unable_vaccinate, ., "unable_vaccinate"),
            vaccinate_facility_time_more_30_min = percent_response(time_travel_vaccinations_facility, .,
                                                                   "between_30_59min",
                                                                   "between_1_2hours",
                                                                   "more_2hours"),
            returnee_chronic_disease = percent_response(filter(., displacement_status == "returnee")[["individual_suffering_chronicdisease"]],
                                                        filter(., displacement_status == "returnee"),
                                                        "yes",
                                                        x_name = "individual_suffering_chronicdisease"),
            returnee_mental_illness = percent_response(filter(., displacement_status == "returnee")[["individual_suffering_mentaldisorder"]],
                                                        filter(., displacement_status == "returnee"),
                                                        "yes",
                                                        x_name = "individual_suffering_mentaldisorder"),
            returnee_physical_difficulty = percent_response(filter(., displacement_status == "returnee")[["physical_cognitive_difficulties"]],
                                                            filter(., displacement_status == "returnee"),
                                                            "yes_male_infants", "yes_male_children", "yes_male_youths", "yes_male_adults",
                                                            "yes_male_elderly", "yes_female_infants", "yes_female_children", "yes_female_youths",
                                                            "yes_female_adults", "yes_female_elderly",
                                                            x_name = "physical_cognitive_difficulties"),
            returnee_behavior_change = percent_response(filter(., displacement_status == "returnee")[["changes_behaviors_minors"]],
                                                        filter(., displacement_status == "returnee"),
                                                        "yes",
                                                        x_name = "changes_behaviors_minors"),
            idp_chronic_disease = percent_response(filter(., displacement_status == "idp")[["individual_suffering_chronicdisease"]],
                                                        filter(., displacement_status == "idp"),
                                                        "yes",
                                                        x_name = "individual_suffering_chronicdisease"),
            idp_mental_illness = percent_response(filter(., displacement_status == "idp")[["individual_suffering_mentaldisorder"]],
                                                       filter(., displacement_status == "idp"),
                                                       "yes",
                                                       x_name = "individual_suffering_mentaldisorder"),
            idp_physical_difficulty = percent_response(filter(., displacement_status == "idp")[["physical_cognitive_difficulties"]],
                                                            filter(., displacement_status == "idp"),
                                                            "yes_male_infants", "yes_male_children", "yes_male_youths", "yes_male_adults",
                                                            "yes_male_elderly", "yes_female_infants", "yes_female_children", "yes_female_youths",
                                                            "yes_female_adults", "yes_female_elderly",
                                                            x_name = "physical_cognitive_difficulties"),
            idp_behavior_change = percent_response(filter(., displacement_status == "idp")[["changes_behaviors_minors"]],
                                                        filter(., displacement_status == "idp"),
                                                        "yes",
                                                        x_name = "changes_behaviors_minors"),
            non_displaced_chronic_disease = percent_response(filter(., displacement_status == "non_displaced")[["individual_suffering_chronicdisease"]],
                                                        filter(., displacement_status == "non_displaced"),
                                                        "yes",
                                                        x_name = "individual_suffering_chronicdisease"),
            non_displaced_mental_illness = percent_response(filter(., displacement_status == "non_displaced")[["individual_suffering_mentaldisorder"]],
                                                       filter(., displacement_status == "non_displaced"),
                                                       "yes",
                                                       x_name = "individual_suffering_mentaldisorder"),
            non_displaced_physical_difficulty = percent_response(filter(., displacement_status == "non_displaced")[["physical_cognitive_difficulties"]],
                                                            filter(., displacement_status == "non_displaced"),
                                                            "yes_male_infants", "yes_male_children", "yes_male_youths", "yes_male_adults",
                                                            "yes_male_elderly", "yes_female_infants", "yes_female_children", "yes_female_youths",
                                                            "yes_female_adults", "yes_female_elderly",
                                                            x_name = "physical_cognitive_difficulties"),
            non_displaced_behavior_change = percent_response(filter(., displacement_status == "non_displaced")[["changes_behaviors_minors"]],
                                                        filter(., displacement_status == "non_displaced"),
                                                        "yes",
                                                        x_name = "changes_behaviors_minors"),
            disease_1_name = select_percents(type_chronicdisease, 1, ., questions, choices, "label"),
            disease_1_pct = select_percents(type_chronicdisease, 1, ., questions, choices, "percent"),
            disease_2_name = select_percents(type_chronicdisease, 2, ., questions, choices, "label"),
            disease_2_pct = select_percents(type_chronicdisease, 2, ., questions, choices, "percent"),
            disease_3_name = select_percents(type_chronicdisease, 3, ., questions, choices, "label"),
            disease_3_pct = select_percents(type_chronicdisease, 3, ., questions, choices, "percent"),
            total_assistance = weighted_sum(total_assistance, .),
            no_daily_difficulty = round(100 * weighted_sum(no_daily_difficulty, .) / total_assistance),
            minor_daily_difficulty = round(100 * weighted_sum(minor_daily_difficulty, .) / total_assistance),
            daily_needs_assistance = round(100 * weighted_sum(daily_needs_assistance, .) / total_assistance),
            neg_behavior_0_12_num_1_name = select_percents(negative_behaviour_0_12, 1, ., questions, choices, "label"),
            neg_behavior_0_12_num_1_pct = select_percents(negative_behaviour_0_12, 1, ., questions, choices, "percent"),
            neg_behavior_0_12_num_2_name = select_percents(negative_behaviour_0_12, 2, ., questions, choices, "label"),
            neg_behavior_0_12_num_2_pct = select_percents(negative_behaviour_0_12, 2, ., questions, choices, "percent"),
            neg_behavior_0_12_num_3_name = select_percents(negative_behaviour_0_12, 3, ., questions, choices, "label"),
            neg_behavior_0_12_num_3_pct = select_percents(negative_behaviour_0_12, 3, ., questions, choices, "percent"),
            neg_behavior_0_12_num_4_name = select_percents(negative_behaviour_0_12, 4, ., questions, choices, "label"),
            neg_behavior_0_12_num_4_pct = select_percents(negative_behaviour_0_12, 4, ., questions, choices, "percent"),
            neg_behavior_0_12_num_5_name = select_percents(negative_behaviour_0_12, 5, ., questions, choices, "label"),
            neg_behavior_0_12_num_5_pct = select_percents(negative_behaviour_0_12, 5, ., questions, choices, "percent"),
            neg_behavior_13_17_num_1_name = select_percents(negative_behaviour_13_17, 1, ., questions, choices, "label"),
            neg_behavior_13_17_num_1_pct = select_percents(negative_behaviour_13_17, 1, ., questions, choices, "percent"),
            neg_behavior_13_17_num_2_name = select_percents(negative_behaviour_13_17, 2, ., questions, choices, "label"),
            neg_behavior_13_17_num_2_pct = select_percents(negative_behaviour_13_17, 2, ., questions, choices, "percent"),
            neg_behavior_13_17_num_3_name = select_percents(negative_behaviour_13_17, 3, ., questions, choices, "label"),
            neg_behavior_13_17_num_3_pct = select_percents(negative_behaviour_13_17, 3, ., questions, choices, "percent"),
            neg_behavior_13_17_num_4_name = select_percents(negative_behaviour_13_17, 4, ., questions, choices, "label"),
            neg_behavior_13_17_num_4_pct = select_percents(negative_behaviour_13_17, 4, ., questions, choices, "percent"),
            neg_behavior_13_17_num_5_name = select_percents(negative_behaviour_13_17, 5, ., questions, choices, "label"),
            neg_behavior_13_17_num_5_pct = select_percents(negative_behaviour_13_17, 5, ., questions, choices, "percent"),
            returnee_child_male = weighted_sum(filter(., displacement_status == "returnee")[["nb_children_male_edu"]],
                                               filter(., displacement_status == "returnee"),
                                               x_name = "nb_children_male_edu"),
            returnee_enrolled_child_male = weighted_sum(filter(., displacement_status == "returnee")[["enrolled_school_male_6_14_edu"]],
                                                                    filter(., displacement_status == "returnee"),
                                                                    x_name = "enrolled_school_male_6_14_edu"),
            returnee_enrolled_child_male_pct = round(100 * returnee_enrolled_child_male / returnee_child_male, 0),
            returnee_attending_child_male = weighted_sum(filter(., displacement_status == "returnee")[["attended_school_male_6_14"]],
                                                         filter(., displacement_status == "returnee"),
                                                         x_name = "attended_school_male_6_14"),
            returnee_attending_child_male_pct = round(100 * returnee_attending_child_male / returnee_enrolled_child_male, 0),
            returnee_youth_male = weighted_sum(filter(., displacement_status == "returnee")[["nb_youth_male_edu"]],
                                               filter(., displacement_status == "returnee"),
                                               x_name = "nb_youth_male_edu"),
            returnee_enrolled_youth_male = weighted_sum(filter(., displacement_status == "returnee")[["enrolled_school_male_15_17_edu"]],
                                                                    filter(., displacement_status == "returnee"),
                                                                    x_name = "enrolled_school_male_15_17_edu"),
            returnee_enrolled_youth_male_pct = round(100 * returnee_enrolled_youth_male / returnee_youth_male, 0),
            returnee_attending_youth_male = weighted_sum(filter(., displacement_status == "returnee")[["attended_school_male_15_17"]],
                                                         filter(., displacement_status == "returnee"),
                                                         x_name = "attended_school_male_15_17"),
            returnee_attending_youth_male_pct = round(100 * returnee_attending_youth_male / returnee_enrolled_youth_male, 0),
            returnee_child_female = weighted_sum(filter(., displacement_status == "returnee")[["nb_children_female_edu"]],
                                               filter(., displacement_status == "returnee"),
                                               x_name = "nb_children_female_edu"),
            returnee_enrolled_child_female = weighted_sum(filter(., displacement_status == "returnee")[["enrolled_school_female_6_14_edu"]],
                                                        filter(., displacement_status == "returnee"),
                                                        x_name = "enrolled_school_female_6_14_edu"),
            returnee_enrolled_child_female_pct = round(100 * returnee_enrolled_child_female / returnee_child_female, 0),
            returnee_attending_child_female = weighted_sum(filter(., displacement_status == "returnee")[["attended_school_female_6_14"]],
                                                         filter(., displacement_status == "returnee"),
                                                         x_name = "attended_school_female_6_14"),
            returnee_attending_child_female_pct = round(100 * returnee_attending_child_female / returnee_enrolled_child_female, 0),
            returnee_youth_female = weighted_sum(filter(., displacement_status == "returnee")[["nb_youth_female_edu"]],
                                               filter(., displacement_status == "returnee"),
                                               x_name = "nb_youth_female_edu"),
            returnee_enrolled_youth_female = weighted_sum(filter(., displacement_status == "returnee")[["enrolled_school_female_15_17_edu"]],
                                                        filter(., displacement_status == "returnee"),
                                                        x_name = "enrolled_school_female_15_17_edu"),
            returnee_enrolled_youth_female_pct = round(100 * returnee_enrolled_youth_female / returnee_youth_female, 0),
            returnee_attending_youth_female = weighted_sum(filter(., displacement_status == "returnee")[["attended_school_female_15_17"]],
                                                         filter(., displacement_status == "returnee"),
                                                         x_name = "attended_school_female_15_17"),
            returnee_attending_youth_female_pct = round(100 * returnee_attending_youth_female / returnee_enrolled_youth_female, 0),
            idp_child_male = weighted_sum(filter(., displacement_status == "idp")[["nb_children_male_edu"]],
                                               filter(., displacement_status == "idp"),
                                               x_name = "nb_children_male_edu"),
            idp_enrolled_child_male = weighted_sum(filter(., displacement_status == "idp")[["enrolled_school_male_6_14_edu"]],
                                                        filter(., displacement_status == "idp"),
                                                        x_name = "enrolled_school_male_6_14_edu"),
            idp_enrolled_child_male_pct = round(100 * idp_enrolled_child_male / idp_child_male, 0),
            idp_attending_child_male = weighted_sum(filter(., displacement_status == "idp")[["attended_school_male_6_14"]],
                                                         filter(., displacement_status == "idp"),
                                                         x_name = "attended_school_male_6_14"),
            idp_attending_child_male_pct = round(100 * idp_attending_child_male / idp_enrolled_child_male, 0),
            idp_youth_male = weighted_sum(filter(., displacement_status == "idp")[["nb_youth_male_edu"]],
                                               filter(., displacement_status == "idp"),
                                               x_name = "nb_youth_male_edu"),
            idp_enrolled_youth_male = weighted_sum(filter(., displacement_status == "idp")[["enrolled_school_male_15_17_edu"]],
                                                        filter(., displacement_status == "idp"),
                                                        x_name = "enrolled_school_male_15_17_edu"),
            idp_enrolled_youth_male_pct = round(100 * idp_enrolled_youth_male / idp_youth_male, 0),
            idp_attending_youth_male = weighted_sum(filter(., displacement_status == "idp")[["attended_school_male_15_17"]],
                                                         filter(., displacement_status == "idp"),
                                                         x_name = "attended_school_male_15_17"),
            idp_attending_youth_male_pct = round(100 * idp_attending_youth_male / idp_enrolled_youth_male, 0),
            idp_child_female = weighted_sum(filter(., displacement_status == "idp")[["nb_children_female_edu"]],
                                                 filter(., displacement_status == "idp"),
                                                 x_name = "nb_children_female_edu"),
            idp_enrolled_child_female = weighted_sum(filter(., displacement_status == "idp")[["enrolled_school_female_6_14_edu"]],
                                                          filter(., displacement_status == "idp"),
                                                          x_name = "enrolled_school_female_6_14_edu"),
            idp_enrolled_child_female_pct = round(100 * idp_enrolled_child_female / idp_child_female, 0),
            idp_attending_child_female = weighted_sum(filter(., displacement_status == "idp")[["attended_school_female_6_14"]],
                                                           filter(., displacement_status == "idp"),
                                                           x_name = "attended_school_female_6_14"),
            idp_attending_child_female_pct = round(100 * idp_attending_child_female / idp_enrolled_child_female, 0),
            idp_youth_female = weighted_sum(filter(., displacement_status == "idp")[["nb_youth_female_edu"]],
                                                 filter(., displacement_status == "idp"),
                                                 x_name = "nb_youth_female_edu"),
            idp_enrolled_youth_female = weighted_sum(filter(., displacement_status == "idp")[["enrolled_school_female_15_17_edu"]],
                                                          filter(., displacement_status == "idp"),
                                                          x_name = "enrolled_school_female_15_17_edu"),
            idp_enrolled_youth_female_pct = round(100 * idp_enrolled_youth_female / idp_youth_female, 0),
            idp_attending_youth_female = weighted_sum(filter(., displacement_status == "idp")[["attended_school_female_15_17"]],
                                                           filter(., displacement_status == "idp"),
                                                           x_name = "attended_school_female_15_17"),
            idp_attending_youth_female_pct = round(100 * idp_attending_youth_female / idp_enrolled_youth_female, 0),
            non_displaced_child_male = weighted_sum(filter(., displacement_status == "non_displaced")[["nb_children_male_edu"]],
                                               filter(., displacement_status == "non_displaced"),
                                               x_name = "nb_children_male_edu"),
            non_displaced_enrolled_child_male = weighted_sum(filter(., displacement_status == "non_displaced")[["enrolled_school_male_6_14_edu"]],
                                                        filter(., displacement_status == "non_displaced"),
                                                        x_name = "enrolled_school_male_6_14_edu"),
            non_displaced_enrolled_child_male_pct = round(100 * non_displaced_enrolled_child_male / non_displaced_child_male, 0),
            non_displaced_attending_child_male = weighted_sum(filter(., displacement_status == "non_displaced")[["attended_school_male_6_14"]],
                                                         filter(., displacement_status == "non_displaced"),
                                                         x_name = "attended_school_male_6_14"),
            non_displaced_attending_child_male_pct = round(100 * non_displaced_attending_child_male / non_displaced_enrolled_child_male, 0),
            non_displaced_youth_male = weighted_sum(filter(., displacement_status == "non_displaced")[["nb_youth_male_edu"]],
                                               filter(., displacement_status == "non_displaced"),
                                               x_name = "nb_youth_male_edu"),
            non_displaced_enrolled_youth_male = weighted_sum(filter(., displacement_status == "non_displaced")[["enrolled_school_male_15_17_edu"]],
                                                        filter(., displacement_status == "non_displaced"),
                                                        x_name = "enrolled_school_male_15_17_edu"),
            non_displaced_enrolled_youth_male_pct = round(100 * non_displaced_enrolled_youth_male / non_displaced_youth_male, 0),
            non_displaced_attending_youth_male = weighted_sum(filter(., displacement_status == "non_displaced")[["attended_school_male_15_17"]],
                                                         filter(., displacement_status == "non_displaced"),
                                                         x_name = "attended_school_male_15_17"),
            non_displaced_attending_youth_male_pct = round(100 * non_displaced_attending_youth_male / non_displaced_enrolled_youth_male, 0),
            non_displaced_child_female = weighted_sum(filter(., displacement_status == "non_displaced")[["nb_children_female_edu"]],
                                                 filter(., displacement_status == "non_displaced"),
                                                 x_name = "nb_children_female_edu"),
            non_displaced_enrolled_child_female = weighted_sum(filter(., displacement_status == "non_displaced")[["enrolled_school_female_6_14_edu"]],
                                                          filter(., displacement_status == "non_displaced"),
                                                          x_name = "enrolled_school_female_6_14_edu"),
            non_displaced_enrolled_child_female_pct = round(100 * non_displaced_enrolled_child_female / non_displaced_child_female, 0),
            non_displaced_attending_child_female = weighted_sum(filter(., displacement_status == "non_displaced")[["attended_school_female_6_14"]],
                                                           filter(., displacement_status == "non_displaced"),
                                                           x_name = "attended_school_female_6_14"),
            non_displaced_attending_child_female_pct = round(100 * non_displaced_attending_child_female / non_displaced_enrolled_child_female, 0),
            non_displaced_youth_female = weighted_sum(filter(., displacement_status == "non_displaced")[["nb_youth_female_edu"]],
                                                 filter(., displacement_status == "non_displaced"),
                                                 x_name = "nb_youth_female_edu"),
            non_displaced_enrolled_youth_female = weighted_sum(filter(., displacement_status == "non_displaced")[["enrolled_school_female_15_17_edu"]],
                                                          filter(., displacement_status == "non_displaced"),
                                                          x_name = "enrolled_school_female_15_17_edu"),
            non_displaced_enrolled_youth_female_pct = round(100 * non_displaced_enrolled_youth_female / non_displaced_youth_female, 0),
            non_displaced_attending_youth_female = weighted_sum(filter(., displacement_status == "non_displaced")[["attended_school_female_15_17"]],
                                                           filter(., displacement_status == "non_displaced"),
                                                           x_name = "attended_school_female_15_17"),
            non_displaced_attending_youth_female_pct = round(100 * non_displaced_attending_youth_female / non_displaced_enrolled_youth_female, 0),
            attendance_issue_1_name = select_percents(issues_faced_attending_school, 1, ., questions, choices, "label"),
            attendance_issue_1_pct = select_percents(issues_faced_attending_school, 1, ., questions, choices, "percent"),
            attendance_issue_2_name = select_percents(issues_faced_attending_school, 2, ., questions, choices, "label"),
            attendance_issue_2_pct = select_percents(issues_faced_attending_school, 2, ., questions, choices, "percent"),
            attendance_issue_3_name = select_percents(issues_faced_attending_school, 3, ., questions, choices, "label"),
            attendance_issue_3_pct = select_percents(issues_faced_attending_school, 3, ., questions, choices, "percent"),
            no_attendance_reason_1_name = select_percents(droppedout_school_reasons, 1, ., questions, choices, "label"),
            no_attendance_reason_1_pct = select_percents(droppedout_school_reasons, 1, ., questions, choices, "percent"),
            no_attendance_reason_2_name = select_percents(droppedout_school_reasons, 2, ., questions, choices, "label"),
            no_attendance_reason_2_pct = select_percents(droppedout_school_reasons, 2, ., questions, choices, "percent"),
            no_attendance_reason_3_name = select_percents(droppedout_school_reasons, 3, ., questions, choices, "label"),
            no_attendance_reason_3_pct = select_percents(droppedout_school_reasons, 3, ., questions, choices, "percent"),
            no_attendance_reason_4_name = select_percents(droppedout_school_reasons, 4, ., questions, choices, "label"),
            no_attendance_reason_4_pct = select_percents(droppedout_school_reasons, 4, ., questions, choices, "percent"),
            no_attendance_reason_5_name = select_percents(droppedout_school_reasons, 5, ., questions, choices, "label"),
            no_attendance_reason_5_pct = select_percents(droppedout_school_reasons, 5, ., questions, choices, "percent"),
            returnee_nonformal_school = percent_response(filter(., displacement_status == "returnee")[["nonformal_education"]],
                                                         filter(., displacement_status == "returnee"),
                                                         "yes_nonformal_classes_byschool",
                                                         x_name = "nonformal_education"),
            returnee_nonformal_community = percent_response(filter(., displacement_status == "returnee")[["nonformal_education"]],
                                                         filter(., displacement_status == "returnee"),
                                                         "yes_nonformal_classes_bycommunity",
                                                         x_name = "nonformal_education"),
            returnee_nonformal_priv_bus = percent_response(filter(., displacement_status == "returnee")[["nonformal_education"]],
                                                            filter(., displacement_status == "returnee"),
                                                            "yes_nonformal_privatebusiness",
                                                            x_name = "nonformal_education"),
            returnee_nonformal_self = percent_response(filter(., displacement_status == "returnee")[["nonformal_education"]],
                                                           filter(., displacement_status == "returnee"),
                                                           "yes_selflearning",
                                                           x_name = "nonformal_education"),
            returnee_nonformal_ngo = percent_response(filter(., displacement_status == "returnee")[["nonformal_education"]],
                                                       filter(., displacement_status == "returnee"),
                                                       "yes_assistance_ngos",
                                                       x_name = "nonformal_education"),
            returnee_nonformal_other = percent_response(filter(., displacement_status == "returnee")[["nonformal_education"]],
                                                      filter(., displacement_status == "returnee"),
                                                      "other",
                                                      x_name = "nonformal_education"),
            returnee_nonformal_total = returnee_nonformal_ngo + returnee_nonformal_community + returnee_nonformal_priv_bus + returnee_nonformal_school + returnee_nonformal_self + returnee_nonformal_other,
            idp_nonformal_school = percent_response(filter(., displacement_status == "idp")[["nonformal_education"]],
                                                         filter(., displacement_status == "idp"),
                                                         "yes_nonformal_classes_byschool",
                                                         x_name = "nonformal_education"),
            idp_nonformal_community = percent_response(filter(., displacement_status == "idp")[["nonformal_education"]],
                                                            filter(., displacement_status == "idp"),
                                                            "yes_nonformal_classes_bycommunity",
                                                            x_name = "nonformal_education"),
            idp_nonformal_priv_bus = percent_response(filter(., displacement_status == "idp")[["nonformal_education"]],
                                                           filter(., displacement_status == "idp"),
                                                           "yes_nonformal_privatebusiness",
                                                           x_name = "nonformal_education"),
            idp_nonformal_self = percent_response(filter(., displacement_status == "idp")[["nonformal_education"]],
                                                       filter(., displacement_status == "idp"),
                                                       "yes_selflearning",
                                                       x_name = "nonformal_education"),
            idp_nonformal_ngo = percent_response(filter(., displacement_status == "idp")[["nonformal_education"]],
                                                      filter(., displacement_status == "idp"),
                                                      "yes_assistance_ngos",
                                                      x_name = "nonformal_education"),
            idp_nonformal_other = percent_response(filter(., displacement_status == "idp")[["nonformal_education"]],
                                                        filter(., displacement_status == "idp"),
                                                        "other",
                                                        x_name = "nonformal_education"),
            idp_nonformal_total = idp_nonformal_ngo + idp_nonformal_community + idp_nonformal_priv_bus + idp_nonformal_school + idp_nonformal_self + idp_nonformal_other,
            non_displaced_nonformal_school = percent_response(filter(., displacement_status == "non_displaced")[["nonformal_education"]],
                                                         filter(., displacement_status == "non_displaced"),
                                                         "yes_nonformal_classes_byschool",
                                                         x_name = "nonformal_education"),
            non_displaced_nonformal_community = percent_response(filter(., displacement_status == "non_displaced")[["nonformal_education"]],
                                                            filter(., displacement_status == "non_displaced"),
                                                            "yes_nonformal_classes_bycommunity",
                                                            x_name = "nonformal_education"),
            non_displaced_nonformal_priv_bus = percent_response(filter(., displacement_status == "non_displaced")[["nonformal_education"]],
                                                           filter(., displacement_status == "non_displaced"),
                                                           "yes_nonformal_privatebusiness",
                                                           x_name = "nonformal_education"),
            non_displaced_nonformal_self = percent_response(filter(., displacement_status == "non_displaced")[["nonformal_education"]],
                                                       filter(., displacement_status == "non_displaced"),
                                                       "yes_selflearning",
                                                       x_name = "nonformal_education"),
            non_displaced_nonformal_ngo = percent_response(filter(., displacement_status == "non_displaced")[["nonformal_education"]],
                                                      filter(., displacement_status == "non_displaced"),
                                                      "yes_assistance_ngos",
                                                      x_name = "nonformal_education"),
            non_displaced_nonformal_other = percent_response(filter(., displacement_status == "non_displaced")[["nonformal_education"]],
                                                        filter(., displacement_status == "non_displaced"),
                                                        "other",
                                                        x_name = "nonformal_education"),
            non_displaced_nonformal_total = non_displaced_nonformal_ngo + non_displaced_nonformal_community + non_displaced_nonformal_priv_bus + non_displaced_nonformal_school + non_displaced_nonformal_self + non_displaced_nonformal_other,
            returnee_document_need_1_name = select_percents(filter(., displacement_status == "returnee")[["document_needs"]],
                                                            1,
                                                            filter(., displacement_status == "returnee"),
                                                            questions,
                                                            choices,
                                                            "label",
                                                            x_name = "document_needs"),
            returnee_document_need_1_pct = select_percents(filter(., displacement_status == "returnee")[["document_needs"]],
                                                            1,
                                                            filter(., displacement_status == "returnee"),
                                                            questions,
                                                            choices,
                                                            "percent",
                                                            x_name = "document_needs"),
            returnee_document_need_2_name = select_percents(filter(., displacement_status == "returnee")[["document_needs"]],
                                                            2,
                                                            filter(., displacement_status == "returnee"),
                                                            questions,
                                                            choices,
                                                            "label",
                                                            x_name = "document_needs"),
            returnee_document_need_2_pct = select_percents(filter(., displacement_status == "returnee")[["document_needs"]],
                                                           2,
                                                           filter(., displacement_status == "returnee"),
                                                           questions,
                                                           choices,
                                                           "percent",
                                                           x_name = "document_needs"),
            returnee_document_need_3_name = select_percents(filter(., displacement_status == "returnee")[["document_needs"]],
                                                            3,
                                                            filter(., displacement_status == "returnee"),
                                                            questions,
                                                            choices,
                                                            "label",
                                                            x_name = "document_needs"),
            returnee_document_need_3_pct = select_percents(filter(., displacement_status == "returnee")[["document_needs"]],
                                                           3,
                                                           filter(., displacement_status == "returnee"),
                                                           questions,
                                                           choices,
                                                           "percent",
                                                           x_name = "document_needs"),
            idp_document_need_1_name = select_percents(filter(., displacement_status == "idp")[["document_needs"]],
                                                            1,
                                                            filter(., displacement_status == "idp"),
                                                            questions,
                                                            choices,
                                                            "label",
                                                            x_name = "document_needs"),
            idp_document_need_1_pct = select_percents(filter(., displacement_status == "idp")[["document_needs"]],
                                                           1,
                                                           filter(., displacement_status == "idp"),
                                                           questions,
                                                           choices,
                                                           "percent",
                                                           x_name = "document_needs"),
            idp_document_need_2_name = select_percents(filter(., displacement_status == "idp")[["document_needs"]],
                                                            2,
                                                            filter(., displacement_status == "idp"),
                                                            questions,
                                                            choices,
                                                            "label",
                                                            x_name = "document_needs"),
            idp_document_need_2_pct = select_percents(filter(., displacement_status == "idp")[["document_needs"]],
                                                           2,
                                                           filter(., displacement_status == "idp"),
                                                           questions,
                                                           choices,
                                                           "percent",
                                                           x_name = "document_needs"),
            idp_document_need_3_name = select_percents(filter(., displacement_status == "idp")[["document_needs"]],
                                                            3,
                                                            filter(., displacement_status == "idp"),
                                                            questions,
                                                            choices,
                                                            "label",
                                                            x_name = "document_needs"),
            idp_document_need_3_pct = select_percents(filter(., displacement_status == "idp")[["document_needs"]],
                                                           3,
                                                           filter(., displacement_status == "idp"),
                                                           questions,
                                                           choices,
                                                           "percent",
                                                           x_name = "document_needs"),
            non_displaced_document_need_1_name = select_percents(filter(., displacement_status == "non_displaced")[["document_needs"]],
                                                            1,
                                                            filter(., displacement_status == "non_displaced"),
                                                            questions,
                                                            choices,
                                                            "label",
                                                            x_name = "document_needs"),
            non_displaced_document_need_1_pct = select_percents(filter(., displacement_status == "non_displaced")[["document_needs"]],
                                                           1,
                                                           filter(., displacement_status == "non_displaced"),
                                                           questions,
                                                           choices,
                                                           "percent",
                                                           x_name = "document_needs"),
            non_displaced_document_need_2_name = select_percents(filter(., displacement_status == "non_displaced")[["document_needs"]],
                                                            2,
                                                            filter(., displacement_status == "non_displaced"),
                                                            questions,
                                                            choices,
                                                            "label",
                                                            x_name = "document_needs"),
            non_displaced_document_need_2_pct = select_percents(filter(., displacement_status == "non_displaced")[["document_needs"]],
                                                           2,
                                                           filter(., displacement_status == "non_displaced"),
                                                           questions,
                                                           choices,
                                                           "percent",
                                                           x_name = "document_needs"),
            non_displaced_document_need_3_name = select_percents(filter(., displacement_status == "non_displaced")[["document_needs"]],
                                                            3,
                                                            filter(., displacement_status == "non_displaced"),
                                                            questions,
                                                            choices,
                                                            "label",
                                                            x_name = "document_needs"),
            non_displaced_document_need_3_pct = select_percents(filter(., displacement_status == "non_displaced")[["document_needs"]],
                                                           3,
                                                           filter(., displacement_status == "non_displaced"),
                                                           questions,
                                                           choices,
                                                           "percent",
                                                           x_name = "document_needs"),
            returnee_doc_loss_impact_1_name = select_percents(filter(., displacement_status == "returnee")[["losing_legal_docs_impact"]],
                                                              1,
                                                              filter(., displacement_status == "returnee"),
                                                              questions,
                                                              choices,
                                                              "label",
                                                              x_name = "losing_legal_docs_impact"),
            returnee_doc_loss_impact_1_pct = select_percents(filter(., displacement_status == "returnee")[["losing_legal_docs_impact"]],
                                                              1,
                                                              filter(., displacement_status == "returnee"),
                                                              questions,
                                                              choices,
                                                              "percent",
                                                              x_name = "losing_legal_docs_impact"),
            returnee_doc_loss_impact_2_name = select_percents(filter(., displacement_status == "returnee")[["losing_legal_docs_impact"]],
                                                              2,
                                                              filter(., displacement_status == "returnee"),
                                                              questions,
                                                              choices,
                                                              "label",
                                                              x_name = "losing_legal_docs_impact"),
            returnee_doc_loss_impact_2_pct = select_percents(filter(., displacement_status == "returnee")[["losing_legal_docs_impact"]],
                                                             2,
                                                             filter(., displacement_status == "returnee"),
                                                             questions,
                                                             choices,
                                                             "percent",
                                                             x_name = "losing_legal_docs_impact"),
            returnee_doc_loss_impact_3_name = select_percents(filter(., displacement_status == "returnee")[["losing_legal_docs_impact"]],
                                                              3,
                                                              filter(., displacement_status == "returnee"),
                                                              questions,
                                                              choices,
                                                              "label",
                                                              x_name = "losing_legal_docs_impact"),
            returnee_doc_loss_impact_3_pct = select_percents(filter(., displacement_status == "returnee")[["losing_legal_docs_impact"]],
                                                             3,
                                                             filter(., displacement_status == "returnee"),
                                                             questions,
                                                             choices,
                                                             "percent",
                                                             x_name = "losing_legal_docs_impact"),
            idp_doc_loss_impact_1_name = select_percents(filter(., displacement_status == "idp")[["losing_legal_docs_impact"]],
                                                              1,
                                                              filter(., displacement_status == "idp"),
                                                              questions,
                                                              choices,
                                                              "label",
                                                              x_name = "losing_legal_docs_impact"),
            idp_doc_loss_impact_1_pct = select_percents(filter(., displacement_status == "idp")[["losing_legal_docs_impact"]],
                                                             1,
                                                             filter(., displacement_status == "idp"),
                                                             questions,
                                                             choices,
                                                             "percent",
                                                             x_name = "losing_legal_docs_impact"),
            idp_doc_loss_impact_2_name = select_percents(filter(., displacement_status == "idp")[["losing_legal_docs_impact"]],
                                                              2,
                                                              filter(., displacement_status == "idp"),
                                                              questions,
                                                              choices,
                                                              "label",
                                                              x_name = "losing_legal_docs_impact"),
            idp_doc_loss_impact_2_pct = select_percents(filter(., displacement_status == "idp")[["losing_legal_docs_impact"]],
                                                             2,
                                                             filter(., displacement_status == "idp"),
                                                             questions,
                                                             choices,
                                                             "percent",
                                                             x_name = "losing_legal_docs_impact"),
            idp_doc_loss_impact_3_name = select_percents(filter(., displacement_status == "idp")[["losing_legal_docs_impact"]],
                                                              3,
                                                              filter(., displacement_status == "idp"),
                                                              questions,
                                                              choices,
                                                              "label",
                                                              x_name = "losing_legal_docs_impact"),
            idp_doc_loss_impact_3_pct = select_percents(filter(., displacement_status == "idp")[["losing_legal_docs_impact"]],
                                                             3,
                                                             filter(., displacement_status == "idp"),
                                                             questions,
                                                             choices,
                                                             "percent",
                                                             x_name = "losing_legal_docs_impact"),
            non_displaced_doc_loss_impact_1_name = select_percents(filter(., displacement_status == "non_displaced")[["losing_legal_docs_impact"]],
                                                              1,
                                                              filter(., displacement_status == "non_displaced"),
                                                              questions,
                                                              choices,
                                                              "label",
                                                              x_name = "losing_legal_docs_impact"),
            non_displaced_doc_loss_impact_1_pct = select_percents(filter(., displacement_status == "non_displaced")[["losing_legal_docs_impact"]],
                                                             1,
                                                             filter(., displacement_status == "non_displaced"),
                                                             questions,
                                                             choices,
                                                             "percent",
                                                             x_name = "losing_legal_docs_impact"),
            non_displaced_doc_loss_impact_2_name = select_percents(filter(., displacement_status == "non_displaced")[["losing_legal_docs_impact"]],
                                                              2,
                                                              filter(., displacement_status == "non_displaced"),
                                                              questions,
                                                              choices,
                                                              "label",
                                                              x_name = "losing_legal_docs_impact"),
            non_displaced_doc_loss_impact_2_pct = select_percents(filter(., displacement_status == "non_displaced")[["losing_legal_docs_impact"]],
                                                             2,
                                                             filter(., displacement_status == "non_displaced"),
                                                             questions,
                                                             choices,
                                                             "percent",
                                                             x_name = "losing_legal_docs_impact"),
            non_displaced_doc_loss_impact_3_name = select_percents(filter(., displacement_status == "non_displaced")[["losing_legal_docs_impact"]],
                                                              3,
                                                              filter(., displacement_status == "non_displaced"),
                                                              questions,
                                                              choices,
                                                              "label",
                                                              x_name = "losing_legal_docs_impact"),
            non_displaced_doc_loss_impact_3_pct = select_percents(filter(., displacement_status == "non_displaced")[["losing_legal_docs_impact"]],
                                                             3,
                                                             filter(., displacement_status == "non_displaced"),
                                                             questions,
                                                             choices,
                                                             "percent",
                                                             x_name = "losing_legal_docs_impact"),
            aware_explosives = percent_response(presence_explosive_hazards, ., "yes"),
            explosive_action_1_name = select_percents(presence_explosive_hazards_actions, 1, ., questions, choices, "label"),
            explosive_action_1_pct = select_percents(presence_explosive_hazards_actions, 1, ., questions, choices, "percent"),
            explosive_action_2_name = select_percents(presence_explosive_hazards_actions, 2, ., questions, choices, "label"),
            explosive_action_2_pct = select_percents(presence_explosive_hazards_actions, 2, ., questions, choices, "percent"),
            explosive_action_3_name = select_percents(presence_explosive_hazards_actions, 3, ., questions, choices, "label"),
            explosive_action_3_pct = select_percents(presence_explosive_hazards_actions, 3, ., questions, choices, "percent"),
            explosive_action_3_other_pct = 100 - explosive_action_1_pct - explosive_action_2_pct - explosive_action_3_pct,
            no_explosive_awareness = percent_response(explosive_hazards_risk_awareness, ., "no"),
            member_killed_injured = percent_response(explosive_hazards_injured, .,
                                                     "yes_adult_injured",
                                                     "yes_adult_killes",
                                                     "yes_children_injured",
                                                     "yes_children_killed"),
            missing_members = percent_response(missing_family_members, ., "yes"),
            movement_restrictions = percent_response(movement_restrictions, ., "yes"),
            returnee_priority_need_1_name = select_percents(filter(., displacement_status == "returnee")[["priority_needs"]],
                                                            1,
                                                            filter(., displacement_status == "returnee"),
                                                            questions,
                                                            choices,
                                                            "label",
                                                            x_name = "priority_needs"),
            returnee_priority_need_1_pct = select_percents(filter(., displacement_status == "returnee")[["priority_needs"]],
                                                            2,
                                                            filter(., displacement_status == "returnee"),
                                                            questions,
                                                            choices,
                                                            "percent",
                                                            x_name = "priority_needs"),
            returnee_priority_need_2_name = select_percents(filter(., displacement_status == "returnee")[["priority_needs"]],
                                                            1,
                                                            filter(., displacement_status == "returnee"),
                                                            questions,
                                                            choices,
                                                            "label",
                                                            x_name = "priority_needs"),
            returnee_priority_need_2_pct = select_percents(filter(., displacement_status == "returnee")[["priority_needs"]],
                                                           2,
                                                           filter(., displacement_status == "returnee"),
                                                           questions,
                                                           choices,
                                                           "percent",
                                                           x_name = "priority_needs"),
            returnee_priority_need_3_name = select_percents(filter(., displacement_status == "returnee")[["priority_needs"]],
                                                            3,
                                                            filter(., displacement_status == "returnee"),
                                                            questions,
                                                            choices,
                                                            "label",
                                                            x_name = "priority_needs"),
            returnee_priority_need_3_pct = select_percents(filter(., displacement_status == "returnee")[["priority_needs"]],
                                                           3,
                                                           filter(., displacement_status == "returnee"),
                                                           questions,
                                                           choices,
                                                           "percent",
                                                           x_name = "priority_needs"),
            idp_priority_need_1_name = select_percents(filter(., displacement_status == "idp")[["priority_needs"]],
                                                            1,
                                                            filter(., displacement_status == "idp"),
                                                            questions,
                                                            choices,
                                                            "label",
                                                            x_name = "priority_needs"),
            idp_priority_need_1_pct = select_percents(filter(., displacement_status == "idp")[["priority_needs"]],
                                                           2,
                                                           filter(., displacement_status == "idp"),
                                                           questions,
                                                           choices,
                                                           "percent",
                                                           x_name = "priority_needs"),
            idp_priority_need_2_name = select_percents(filter(., displacement_status == "idp")[["priority_needs"]],
                                                            1,
                                                            filter(., displacement_status == "idp"),
                                                            questions,
                                                            choices,
                                                            "label",
                                                            x_name = "priority_needs"),
            idp_priority_need_2_pct = select_percents(filter(., displacement_status == "idp")[["priority_needs"]],
                                                           2,
                                                           filter(., displacement_status == "idp"),
                                                           questions,
                                                           choices,
                                                           "percent",
                                                           x_name = "priority_needs"),
            idp_priority_need_3_name = select_percents(filter(., displacement_status == "idp")[["priority_needs"]],
                                                            3,
                                                            filter(., displacement_status == "idp"),
                                                            questions,
                                                            choices,
                                                            "label",
                                                            x_name = "priority_needs"),
            idp_priority_need_3_pct = select_percents(filter(., displacement_status == "idp")[["priority_needs"]],
                                                           3,
                                                           filter(., displacement_status == "idp"),
                                                           questions,
                                                           choices,
                                                           "percent",
                                                           x_name = "priority_needs"),
            non_displaced_priority_need_1_name = select_percents(filter(., displacement_status == "non_displaced")[["priority_needs"]],
                                                            1,
                                                            filter(., displacement_status == "non_displaced"),
                                                            questions,
                                                            choices,
                                                            "label",
                                                            x_name = "priority_needs"),
            non_displaced_priority_need_1_pct = select_percents(filter(., displacement_status == "non_displaced")[["priority_needs"]],
                                                           2,
                                                           filter(., displacement_status == "non_displaced"),
                                                           questions,
                                                           choices,
                                                           "percent",
                                                           x_name = "priority_needs"),
            non_displaced_priority_need_2_name = select_percents(filter(., displacement_status == "non_displaced")[["priority_needs"]],
                                                            1,
                                                            filter(., displacement_status == "non_displaced"),
                                                            questions,
                                                            choices,
                                                            "label",
                                                            x_name = "priority_needs"),
            non_displaced_priority_need_2_pct = select_percents(filter(., displacement_status == "non_displaced")[["priority_needs"]],
                                                           2,
                                                           filter(., displacement_status == "non_displaced"),
                                                           questions,
                                                           choices,
                                                           "percent",
                                                           x_name = "priority_needs"),
            non_displaced_priority_need_3_name = select_percents(filter(., displacement_status == "non_displaced")[["priority_needs"]],
                                                            3,
                                                            filter(., displacement_status == "non_displaced"),
                                                            questions,
                                                            choices,
                                                            "label",
                                                            x_name = "priority_needs"),
            non_displaced_priority_need_3_pct = select_percents(filter(., displacement_status == "non_displaced")[["priority_needs"]],
                                                           3,
                                                           filter(., displacement_status == "non_displaced"),
                                                           questions,
                                                           choices,
                                                           "percent",
                                                           x_name = "priority_needs"),
            received_assistance = percent_response(received_humanitarian_assistance, ., "yes"),
            rec_ass_type_1_name = select_percents(modality_assistance_received, 1, ., questions, choices, "label"),
            rec_ass_type_1_pct = select_percents(modality_assistance_received, 1, ., questions, choices, "percent"),
            rec_ass_type_2_name = select_percents(modality_assistance_received, 2, ., questions, choices, "label"),
            rec_ass_type_2_pct = select_percents(modality_assistance_received, 2, ., questions, choices, "percent"),
            rec_ass_type_3_name = select_percents(modality_assistance_received, 3, ., questions, choices, "label"),
            rec_ass_type_3_pct = select_percents(modality_assistance_received, 3, ., questions, choices, "percent"),
            rec_ass_type_4_name = select_percents(modality_assistance_received, 4, ., questions, choices, "label"),
            rec_ass_type_4_pct = select_percents(modality_assistance_received, 4, ., questions, choices, "percent"),
            rec_ass_type_5_name = select_percents(modality_assistance_received, 5, ., questions, choices, "label"),
            rec_ass_type_5_pct = select_percents(modality_assistance_received, 5, ., questions, choices, "percent"),
            assistance_satisfied = percent_response(humanitarian_assistance_satisfaction, ., "yes"),
            returnee_ass_barrier_1_name = select_percents(filter(., displacement_status == "returnee")[["humanitarian_assistance_barriers"]],
                                                          1,
                                                          filter(., displacement_status == "returnee"),
                                                          questions,
                                                          choices,
                                                          "label",
                                                          x_name = "humanitarian_assistance_barriers"),
            returnee_ass_barrier_1_pct = select_percents(filter(., displacement_status == "returnee")[["humanitarian_assistance_barriers"]],
                                                          1,
                                                          filter(., displacement_status == "returnee"),
                                                          questions,
                                                          choices,
                                                          "percent",
                                                          x_name = "humanitarian_assistance_barriers"),
            returnee_ass_barrier_2_name = select_percents(filter(., displacement_status == "returnee")[["humanitarian_assistance_barriers"]],
                                                          2,
                                                          filter(., displacement_status == "returnee"),
                                                          questions,
                                                          choices,
                                                          "label",
                                                          x_name = "humanitarian_assistance_barriers"),
            returnee_ass_barrier_2_pct = select_percents(filter(., displacement_status == "returnee")[["humanitarian_assistance_barriers"]],
                                                         2,
                                                         filter(., displacement_status == "returnee"),
                                                         questions,
                                                         choices,
                                                         "percent",
                                                         x_name = "humanitarian_assistance_barriers"),
            returnee_ass_barrier_3_name = select_percents(filter(., displacement_status == "returnee")[["humanitarian_assistance_barriers"]],
                                                          3,
                                                          filter(., displacement_status == "returnee"),
                                                          questions,
                                                          choices,
                                                          "label",
                                                          x_name = "humanitarian_assistance_barriers"),
            returnee_ass_barrier_3_pct = select_percents(filter(., displacement_status == "returnee")[["humanitarian_assistance_barriers"]],
                                                         3,
                                                         filter(., displacement_status == "returnee"),
                                                         questions,
                                                         choices,
                                                         "percent",
                                                         x_name = "humanitarian_assistance_barriers"),
            idp_ass_barrier_1_name = select_percents(filter(., displacement_status == "idp")[["humanitarian_assistance_barriers"]],
                                                          1,
                                                          filter(., displacement_status == "idp"),
                                                          questions,
                                                          choices,
                                                          "label",
                                                          x_name = "humanitarian_assistance_barriers"),
            idp_ass_barrier_1_pct = select_percents(filter(., displacement_status == "idp")[["humanitarian_assistance_barriers"]],
                                                         1,
                                                         filter(., displacement_status == "idp"),
                                                         questions,
                                                         choices,
                                                         "percent",
                                                         x_name = "humanitarian_assistance_barriers"),
            idp_ass_barrier_2_name = select_percents(filter(., displacement_status == "idp")[["humanitarian_assistance_barriers"]],
                                                          2,
                                                          filter(., displacement_status == "idp"),
                                                          questions,
                                                          choices,
                                                          "label",
                                                          x_name = "humanitarian_assistance_barriers"),
            idp_ass_barrier_2_pct = select_percents(filter(., displacement_status == "idp")[["humanitarian_assistance_barriers"]],
                                                         2,
                                                         filter(., displacement_status == "idp"),
                                                         questions,
                                                         choices,
                                                         "percent",
                                                         x_name = "humanitarian_assistance_barriers"),
            idp_ass_barrier_3_name = select_percents(filter(., displacement_status == "idp")[["humanitarian_assistance_barriers"]],
                                                          3,
                                                          filter(., displacement_status == "idp"),
                                                          questions,
                                                          choices,
                                                          "label",
                                                          x_name = "humanitarian_assistance_barriers"),
            idp_ass_barrier_3_pct = select_percents(filter(., displacement_status == "idp")[["humanitarian_assistance_barriers"]],
                                                         3,
                                                         filter(., displacement_status == "idp"),
                                                         questions,
                                                         choices,
                                                         "percent",
                                                         x_name = "humanitarian_assistance_barriers"),
            non_displaced_ass_barrier_1_name = select_percents(filter(., displacement_status == "non_displaced")[["humanitarian_assistance_barriers"]],
                                                          1,
                                                          filter(., displacement_status == "non_displaced"),
                                                          questions,
                                                          choices,
                                                          "label",
                                                          x_name = "humanitarian_assistance_barriers"),
            non_displaced_ass_barrier_1_pct = select_percents(filter(., displacement_status == "non_displaced")[["humanitarian_assistance_barriers"]],
                                                         1,
                                                         filter(., displacement_status == "non_displaced"),
                                                         questions,
                                                         choices,
                                                         "percent",
                                                         x_name = "humanitarian_assistance_barriers"),
            non_displaced_ass_barrier_2_name = select_percents(filter(., displacement_status == "non_displaced")[["humanitarian_assistance_barriers"]],
                                                          2,
                                                          filter(., displacement_status == "non_displaced"),
                                                          questions,
                                                          choices,
                                                          "label",
                                                          x_name = "humanitarian_assistance_barriers"),
            non_displaced_ass_barrier_2_pct = select_percents(filter(., displacement_status == "non_displaced")[["humanitarian_assistance_barriers"]],
                                                         2,
                                                         filter(., displacement_status == "non_displaced"),
                                                         questions,
                                                         choices,
                                                         "percent",
                                                         x_name = "humanitarian_assistance_barriers"),
            non_displaced_ass_barrier_3_name = select_percents(filter(., displacement_status == "non_displaced")[["humanitarian_assistance_barriers"]],
                                                          3,
                                                          filter(., displacement_status == "non_displaced"),
                                                          questions,
                                                          choices,
                                                          "label",
                                                          x_name = "humanitarian_assistance_barriers"),
            non_displaced_ass_barrier_3_pct = select_percents(filter(., displacement_status == "non_displaced")[["humanitarian_assistance_barriers"]],
                                                         3,
                                                         filter(., displacement_status == "non_displaced"),
                                                         questions,
                                                         choices,
                                                         "percent",
                                                         x_name = "humanitarian_assistance_barriers"),
            returnee_prefer_ass_1_name = select_percents(filter(., displacement_status == "returnee")[["preferred_assistance_modality"]],
                                                         1,
                                                         filter(., displacement_status == "returnee"),
                                                         questions,
                                                         choices,
                                                         "label",
                                                         x_name = "preferred_assistance_modality"),
            returnee_prefer_ass_1_pct = select_percents(filter(., displacement_status == "returnee")[["preferred_assistance_modality"]],
                                                         1,
                                                         filter(., displacement_status == "returnee"),
                                                         questions,
                                                         choices,
                                                         "percent",
                                                         x_name = "preferred_assistance_modality"),
            returnee_prefer_ass_2_name = select_percents(filter(., displacement_status == "returnee")[["preferred_assistance_modality"]],
                                                         2,
                                                         filter(., displacement_status == "returnee"),
                                                         questions,
                                                         choices,
                                                         "label",
                                                         x_name = "preferred_assistance_modality"),
            returnee_prefer_ass_2_pct = select_percents(filter(., displacement_status == "returnee")[["preferred_assistance_modality"]],
                                                        2,
                                                        filter(., displacement_status == "returnee"),
                                                        questions,
                                                        choices,
                                                        "percent",
                                                        x_name = "preferred_assistance_modality"),
            returnee_prefer_ass_3_name = select_percents(filter(., displacement_status == "returnee")[["preferred_assistance_modality"]],
                                                         3,
                                                         filter(., displacement_status == "returnee"),
                                                         questions,
                                                         choices,
                                                         "label",
                                                         x_name = "preferred_assistance_modality"),
            returnee_prefer_ass_3_pct = select_percents(filter(., displacement_status == "returnee")[["preferred_assistance_modality"]],
                                                        3,
                                                        filter(., displacement_status == "returnee"),
                                                        questions,
                                                        choices,
                                                        "percent",
                                                        x_name = "preferred_assistance_modality"),
            idp_prefer_ass_1_name = select_percents(filter(., displacement_status == "idp")[["preferred_assistance_modality"]],
                                                         1,
                                                         filter(., displacement_status == "idp"),
                                                         questions,
                                                         choices,
                                                         "label",
                                                         x_name = "preferred_assistance_modality"),
            idp_prefer_ass_1_pct = select_percents(filter(., displacement_status == "idp")[["preferred_assistance_modality"]],
                                                        1,
                                                        filter(., displacement_status == "idp"),
                                                        questions,
                                                        choices,
                                                        "percent",
                                                        x_name = "preferred_assistance_modality"),
            idp_prefer_ass_2_name = select_percents(filter(., displacement_status == "idp")[["preferred_assistance_modality"]],
                                                         2,
                                                         filter(., displacement_status == "idp"),
                                                         questions,
                                                         choices,
                                                         "label",
                                                         x_name = "preferred_assistance_modality"),
            idp_prefer_ass_2_pct = select_percents(filter(., displacement_status == "idp")[["preferred_assistance_modality"]],
                                                        2,
                                                        filter(., displacement_status == "idp"),
                                                        questions,
                                                        choices,
                                                        "percent",
                                                        x_name = "preferred_assistance_modality"),
            idp_prefer_ass_3_name = select_percents(filter(., displacement_status == "idp")[["preferred_assistance_modality"]],
                                                         3,
                                                         filter(., displacement_status == "idp"),
                                                         questions,
                                                         choices,
                                                         "label",
                                                         x_name = "preferred_assistance_modality"),
            idp_prefer_ass_3_pct = select_percents(filter(., displacement_status == "idp")[["preferred_assistance_modality"]],
                                                        3,
                                                        filter(., displacement_status == "idp"),
                                                        questions,
                                                        choices,
                                                        "percent",
                                                        x_name = "preferred_assistance_modality"),
            non_displaced_prefer_ass_1_name = select_percents(filter(., displacement_status == "non_displaced")[["preferred_assistance_modality"]],
                                                         1,
                                                         filter(., displacement_status == "non_displaced"),
                                                         questions,
                                                         choices,
                                                         "label",
                                                         x_name = "preferred_assistance_modality"),
            non_displaced_prefer_ass_1_pct = select_percents(filter(., displacement_status == "non_displaced")[["preferred_assistance_modality"]],
                                                        1,
                                                        filter(., displacement_status == "non_displaced"),
                                                        questions,
                                                        choices,
                                                        "percent",
                                                        x_name = "preferred_assistance_modality"),
            non_displaced_prefer_ass_2_name = select_percents(filter(., displacement_status == "non_displaced")[["preferred_assistance_modality"]],
                                                         2,
                                                         filter(., displacement_status == "non_displaced"),
                                                         questions,
                                                         choices,
                                                         "label",
                                                         x_name = "preferred_assistance_modality"),
            non_displaced_prefer_ass_2_pct = select_percents(filter(., displacement_status == "non_displaced")[["preferred_assistance_modality"]],
                                                        2,
                                                        filter(., displacement_status == "non_displaced"),
                                                        questions,
                                                        choices,
                                                        "percent",
                                                        x_name = "preferred_assistance_modality"),
            non_displaced_prefer_ass_3_name = select_percents(filter(., displacement_status == "non_displaced")[["preferred_assistance_modality"]],
                                                         3,
                                                         filter(., displacement_status == "non_displaced"),
                                                         questions,
                                                         choices,
                                                         "label",
                                                         x_name = "preferred_assistance_modality"),
            non_displaced_prefer_ass_3_pct = select_percents(filter(., displacement_status == "non_displaced")[["preferred_assistance_modality"]],
                                                        3,
                                                        filter(., displacement_status == "non_displaced"),
                                                        questions,
                                                        choices,
                                                        "percent",
                                                        x_name = "preferred_assistance_modality")) %>%
  mutate(returnee_adult_perm_job = round(100 * returnee_adult_perm_job / returnee_adults, 1),
         returnee_adult_temp_job = round(100 * returnee_adult_temp_job / returnee_adults, 1),
         returnee_adult_daily_labour = round(100 * returnee_adult_daily_labour / returnee_adults, 1),
         returnee_adult_gvt_payroll = round(100 * returnee_adult_gvt_payroll / returnee_adults, 1),
         non_displaced_adult_perm_job = round(100 * non_displaced_adult_perm_job / non_displaced_adults, 1),
         non_displaced_adult_temp_job = round(100 * non_displaced_adult_temp_job / non_displaced_adults, 1),
         non_displaced_adult_daily_labour = round(100 * non_displaced_adult_daily_labour / non_displaced_adults, 1),
         non_displaced_adult_gvt_payroll = round(100 * non_displaced_adult_gvt_payroll / non_displaced_adults, 1),
         idp_adult_perm_job = round(100 * idp_adult_perm_job / idp_adults, 1),
         idp_adult_temp_job = round(100 * idp_adult_temp_job / idp_adults, 1),
         idp_adult_daily_labour = round(100 * idp_adult_daily_labour / idp_adults, 1),
         idp_adult_gvt_payroll = round(100 * idp_adult_gvt_payroll / idp_adults, 1),
         returnee_minor_perm_job = round(100 * returnee_minor_perm_job / returnee_minors, 1),
         returnee_minor_temp_job = round(100 * returnee_minor_temp_job / returnee_minors, 1),
         returnee_minor_daily_labour = round(100 * returnee_minor_daily_labour / returnee_minors, 1),
         idp_minor_perm_job = round(100 * idp_minor_perm_job / idp_minors, 1),
         idp_minor_temp_job = round(100 * idp_minor_temp_job / idp_minors, 1),
         idp_minor_daily_labour = round(100 * idp_minor_daily_labour / idp_minors, 1),
         non_displaced_minor_perm_job = round(100 * non_displaced_minor_perm_job / non_displaced_minors, 1),
         non_displaced_minor_temp_job = round(100 * non_displaced_minor_temp_job / non_displaced_minors, 1),
         non_displaced_minor_daily_labour = round(100 * non_displaced_minor_daily_labour / non_displaced_minors, 1)) %>%
  select(-returnee_adults, -idp_adults, -non_displaced_adults, -returnee_minors, -idp_minors, -non_displaced_minors,
         -total_assistance, -returnee_child_male, -returnee_enrolled_child_male, -returnee_attending_child_male,
         -returnee_youth_male, -returnee_enrolled_youth_male, -returnee_attending_youth_male,
         -returnee_child_female, -returnee_enrolled_child_female, -returnee_attending_child_female,
         -returnee_youth_female, -returnee_enrolled_youth_female, -returnee_attending_youth_female,
         -idp_child_male, -idp_enrolled_child_male, -idp_attending_child_male,
         -idp_youth_male, -idp_enrolled_youth_male, -idp_attending_youth_male,
         -idp_child_female, -idp_enrolled_child_female, -idp_attending_child_female,
         -idp_youth_female, -idp_enrolled_youth_female, -idp_attending_youth_female,
         -non_displaced_child_male, -non_displaced_enrolled_child_male, -non_displaced_attending_child_male,
         -non_displaced_youth_male, -non_displaced_enrolled_youth_male, -non_displaced_attending_youth_male,
         -non_displaced_child_female, -non_displaced_enrolled_child_female, -non_displaced_attending_child_female,
         -non_displaced_youth_female, -non_displaced_enrolled_youth_female, -non_displaced_attending_youth_female,
         -total_people, -total_working_male, -total_working_female)

# we will analyze mantika data for the main FS separately, then merge them

mantika_shelter_damage <- dm_data %>%
  group_by(mantika_label) %>%
  summarize(no_shelter_damage = percent_response(shelter_condition, ., "no_negligible_damage", group = !!get_group(.)),
            light_shelter_damage = percent_response(shelter_condition, ., "light_damage", group = !!get_group(.)),
            medium_shelter_damage = percent_response(shelter_condition, ., "medium_damage", group = !!get_group(.)),
            heavy_shelter_damage = percent_response(shelter_condition, ., "heavy_damage", group = !!get_group(.)),
            shelter_destroyed = percent_response(shelter_condition, ., "shelter_destroyed", group = !!get_group(.))) %>%
  big_spread(mantika_label, c(no_shelter_damage, light_shelter_damage, medium_shelter_damage, heavy_shelter_damage, shelter_destroyed)) %>%
  rename_all(tolower) %>%
  rename_all(str_replace_all, " ", "_")


mantika_public_network <- dm_data %>%
  group_by(mantika_label) %>%
  summarize(power_cuts = weighted_median(power_cuts, ., group = !!get_group(.))) %>%
  spread(mantika_label, power_cuts) %>%
  rename_all(tolower) %>%
  rename_all(str_replace_all, " ", "_") %>%
  rename_all(paste0, "_power_cuts")

mantika_water_distance <- dm_data %>%
  group_by(mantika_label) %>%
  summarize(water_dist_100m = percent_response(distance_drinkingwater, ., "upto_100m", group = !!get_group(.)),
            water_dist_200m = percent_response(distance_drinkingwater, ., "between_101_200m", group = !!get_group(.)),
            water_dist_300m = percent_response(distance_drinkingwater, ., "between_201_300m", group = !!get_group(.)),
            water_dist_400m = percent_response(distance_drinkingwater, ., "between_301_400m", group = !!get_group(.)),
            water_dist_500m = percent_response(distance_drinkingwater, ., "between_401_500m", group = !!get_group(.)),
            water_dist_more_500m = percent_response(distance_drinkingwater, ., "more_500m", group = !!get_group(.))) %>%
  big_spread(mantika_label, c(water_dist_100m, water_dist_200m, water_dist_300m, water_dist_400m, water_dist_500m, water_dist_more_500m))  %>%
  rename_all(tolower) %>%
  rename_all(str_replace_all, " ", "_")

mantika_explosives_awareness <- dm_data %>%
  group_by(mantika_label) %>%
  summarize(aware_explosives = percent_response(presence_explosive_hazards, ., "yes", group = !!get_group(.))) %>%
  spread(mantika_label, aware_explosives) %>%
  rename_all(tolower) %>%
  rename_all(str_replace_all, " ", "_") %>%
  rename_all(paste0, "_aware_explosives")

mantika_water_insufficient <- dm_data %>%
  group_by(mantika_label) %>%
  summarize(sufficient_water = percent_response(unsufficient_quantity_water, ., "yes", group = !!get_group(.))) %>%
  arrange(desc(sufficient_water)) %>%
  slice(1:5) %>%
  t

mantika_water_insufficient_row <- tibble(
  insufficient_water_mantika_1_name = mantika_water_insufficient[1,1],
  insufficient_water_mantika_1_pct = mantika_water_insufficient[2,1],
  insufficient_water_mantika_2_name = mantika_water_insufficient[1,2],
  insufficient_water_mantika_2_pct = mantika_water_insufficient[2,2],
  insufficient_water_mantika_3_name = mantika_water_insufficient[1,3],
  insufficient_water_mantika_3_pct = mantika_water_insufficient[2,3],
  insufficient_water_mantika_4_name = mantika_water_insufficient[1,4],
  insufficient_water_mantika_4_pct = mantika_water_insufficient[2,4],
  insufficient_water_mantika_5_name = mantika_water_insufficient[1,5],
  insufficient_water_mantika_5_pct = mantika_water_insufficient[2,5]
)

mantika_movement_restrictions <- dm_data %>%
  group_by(mantika_label) %>%
  summarize(movement_restrictions = percent_response(movement_restrictions, ., "yes", group = !!get_group(.))) %>%
  arrange(desc(movement_restrictions)) %>%
  slice(1:3) %>%
  t

mantika_movement_restrictions_row <- tibble(
  movement_restriction_mantika_1_name = mantika_movement_restrictions[1,1],
  movement_restriction_mantika_1_pct = mantika_movement_restrictions[2,1],
  movement_restriction_mantika_2_name = mantika_movement_restrictions[1,2],
  movement_restriction_mantika_2_pct = mantika_movement_restrictions[2,2],
  movement_restriction_mantika_3_name = mantika_movement_restrictions[1,3],
  movement_restriction_mantika_3_pct = mantika_movement_restrictions[2,3]
)

## now need to merge this data with the other mantika data

dm_file <- bind_cols(dm_file,
                      mantika_shelter_damage,
                      mantika_public_network,
                      mantika_water_distance,
                      mantika_explosives_awareness,
                      mantika_water_insufficient_row,
                      mantika_movement_restrictions_row)

write_csv(dm_file, "output/sector_data_merge.csv")
